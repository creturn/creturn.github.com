<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Android 上传PHP xUtils Bug修复分析过程 | Return&#39;s Blog </title>
  <meta name="author" content="Return">
  
  <meta name="description" content="专注于互联网开发技术，注重网络安全技术，注重网络攻防技术，注重渗透测试技术，backtrack5渗透测试平台研究，软件开发，网页设计，网页制作，网站建设">
  
  
  <meta property="og:title" content="Android 上传PHP xUtils Bug修复分析过程"/>
  <meta property="og:site_name" content="Return&#39;s Blog "/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta property="og:image" content="undefined"/>
  
   <link rel="apple-touch-icon" href="/icon.png" />
   <link rel="shortcut icon" href="/favicon.png" >
   <link rel="alternate" href="http://www.creturn.com/atom.xml" title="Return&#39;s Blog " type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
</head>


<body>
  <div id="content" class="inner">
    <aside id="sidebar" class="alignleft">
      <div class="navigationBar">
        <a href="/">Return&#39;s Blog </a>
      </div>
    	
  <nav class="widget" id="menu">
	<ul>
    
      <li class="cell"><a class="next" href="/">Home</a><li>
    
      <li class="cell"><a class="next" href="/archives/">Archives</a><li>
    
      <li class="cell"><a class="next" href="/about/">About</a><li>
    
    </ul>
</nav>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/原创作品/">原创作品</a><small>30</small></li>
  
    <li><a href="/categories/原创作品/技术文章/">技术文章</a><small>23</small></li>
  
    <li><a href="/categories/技术文章/">技术文章</a><small>7</small></li>
  
    <li><a href="/categories/原创作品/技术文章/最新漏洞/">最新漏洞</a><small>3</small></li>
  
    <li><a href="/categories/技术文章/最新漏洞/">最新漏洞</a><small>2</small></li>
  
    <li><a href="/categories/最新漏洞/">最新漏洞</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/tags/Android/" style="font-size: 10.00px;">Android</a><a href="/tags/Backtrack5/" style="font-size: 10.00px;">Backtrack5</a><a href="/tags/Metasploit/" style="font-size: 10.00px;">Metasploit</a><a href="/tags/Mysql/" style="font-size: 10.00px;">Mysql</a><a href="/tags/Nginx解析漏洞/" style="font-size: 10.00px;">Nginx解析漏洞</a><a href="/tags/Return/" style="font-size: 10.00px;">Return</a><a href="/tags/ThinkPHP远程/" style="font-size: 10.00px;">ThinkPHP远程</a><a href="/tags/alfred/" style="font-size: 10.00px;">alfred</a><a href="/tags/android/" style="font-size: 13.33px;">android</a><a href="/tags/apache/" style="font-size: 10.00px;">apache</a><a href="/tags/armitage/" style="font-size: 10.00px;">armitage</a><a href="/tags/arp欺骗/" style="font-size: 10.00px;">arp欺骗</a><a href="/tags/cain/" style="font-size: 10.00px;">cain</a><a href="/tags/dedecms漏洞/" style="font-size: 10.00px;">dedecms漏洞</a><a href="/tags/easyui/" style="font-size: 10.00px;">easyui</a><a href="/tags/eclipse/" style="font-size: 10.00px;">eclipse</a><a href="/tags/java/" style="font-size: 10.00px;">java</a><a href="/tags/linux arp欺骗/" style="font-size: 10.00px;">linux arp欺骗</a><a href="/tags/os x/" style="font-size: 10.00px;">os x</a><a href="/tags/php/" style="font-size: 13.33px;">php</a><a href="/tags/phpcmsv9漏洞/" style="font-size: 16.67px;">phpcmsv9漏洞</a><a href="/tags/phpcsm2008漏洞/" style="font-size: 10.00px;">phpcsm2008漏洞</a><a href="/tags/python/" style="font-size: 13.33px;">python</a><a href="/tags/thinkPHP漏洞/" style="font-size: 10.00px;">thinkPHP漏洞</a><a href="/tags/ubuntu/" style="font-size: 10.00px;">ubuntu</a><a href="/tags/web wifi认证/" style="font-size: 10.00px;">web wifi认证</a><a href="/tags/webshell/" style="font-size: 20.00px;">webshell</a><a href="/tags/window密码/" style="font-size: 10.00px;">window密码</a><a href="/tags/wordpress漏洞/" style="font-size: 13.33px;">wordpress漏洞</a><a href="/tags/workflow/" style="font-size: 10.00px;">workflow</a><a href="/tags/xUtils/" style="font-size: 10.00px;">xUtils</a><a href="/tags/互联网技术/" style="font-size: 10.00px;">互联网技术</a><a href="/tags/任意密码登录/" style="font-size: 10.00px;">任意密码登录</a><a href="/tags/任意读取文件漏洞/" style="font-size: 10.00px;">任意读取文件漏洞</a><a href="/tags/入侵/" style="font-size: 10.00px;">入侵</a><a href="/tags/后门/" style="font-size: 20.00px;">后门</a><a href="/tags/嗅探/" style="font-size: 10.00px;">嗅探</a><a href="/tags/图马/" style="font-size: 10.00px;">图马</a><a href="/tags/打飞机/" style="font-size: 10.00px;">打飞机</a><a href="/tags/注入漏洞/" style="font-size: 10.00px;">注入漏洞</a>
  </div>
</div>


    	<footer id="footer" class="inner"><div class="copyright">
  
  &copy; 2014 Return
  
</div>


<div style="position:relative; bottom: 23px">
  <script src="http://s95.cnzz.com/stat.php?id=4287542&web_id=4287542&show=pic1" language="JavaScript">
  </script>
</div>


</footer>
    </aside>
    
    
    <div id="hidden-navigationBar" class="navigationBar">
      <a href="/">Return&#39;s Blog </a>
    </div>
    <div id="main-col" class="alignright">
    <div id="wrapper">
      
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title">Android 上传PHP xUtils Bug修复分析过程</h1>
  

      <time datetime="2014-01-15T07:12:04.000Z"><a href="/html/2014-01-15-android-上传php-xutils-bug修复分析过程.html">1月 15 2014</a></time>
      
  </header>
    <div class="entry">
      
        <h2 id="-">起因</h2>
<p>作为全职PHPer偶尔需要客串下Androider,最近公司的一个项目需要Android的客户端(主要图片特效处理及其上传)，自己就客串下Androider.</p>
<p>之前有过Android开发经验所以做这个挺顺手的，几乎所有东西直接github中拿过来改改就用，不过在处理图片上传的时候选择了xUtils这个</p>
<p>开源工具类,用起来确实比较好用，挺方便的，例如如下代码就可以实现上传:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="code"><pre>RequestParams params = <span class="keyword">new</span> RequestParams();
params.addBodyParameter(<span class="string">"file"</span>, file);
HttpUtils httpUtils = <span class="keyword">new</span> HttpUtils();
httpUtils.send(HttpRequest.HttpMethod.POST, UPLOAD_URL, params, <span class="keyword">new</span> RequestCallBack&lt;String&gt;() {
    <span class="annotation">@Override</span>
    <span class="comment">//上传失败处理方法</span>
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span>(HttpException arg0, String msg) {
        alert(msg);
    }
    <span class="annotation">@Override</span>
    <span class="comment">//上传进度处理</span>
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onLoading</span>(<span class="keyword">long</span> total, <span class="keyword">long</span> current,
            <span class="keyword">boolean</span> isUploading) {
        <span class="keyword">if</span> (isUploading) {
            Log.i(LOG_NAME, <span class="string">"upload:"</span> + current + <span class="string">"/"</span> + total);
        }
    }
    <span class="annotation">@Override</span>
    <span class="comment">//上传成功处理</span>
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span>(ResponseInfo&lt;String&gt; responseInfo) {
        alert(responseInfo.result);
        Log.i(LOG_NAME, responseInfo.result);
    }
});
</pre></td></tr></table></figure>

<p>可以看到用起来比较方便，如果自己写还是比较麻烦的。不过最让人头疼的不是使用方法，而是作为接收端为PHP的话是接收不到上传的文件，最后经证实
不仅仅是PHP C# 也有问题, 网上搜素了下不少人都遇到问题不过没有解决方案，看来只能自己动手解决了</p>
<h2 id="-">问题分析</h2>
<p>既然要解决问题，那么就需要分析bug可能出现的地方，既然是HTTP上传那么我们得知道在PHP 在HTTP协议中文件是怎么处理上传的，直接在官方文档
就可以找到</p>
<blockquote>
<p>PHP 能够接受任何来自符合 RFC-1867 标准的浏览器（包括 Netscape Navigator 3 及更高版本，打了补丁的 Microsoft Internet Explorer 3 或者更高版本）上传的文件。</p>
</blockquote>
<p>这个是PHP官方文档中给出的解释, PHP在处理上传的时候遵循的是RFC-1867标准，那么我们接下来看看什么是RFC-1867。</p>
<p>这里我给出一个RFC-1867的说明文档地址 <a href="http://www.ietf.org/rfc/rfc1867.txt" target="_blank">RFC-1867 说明</a>，太长了就不放在这里了只拿核心重点内容过来看看：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="code"><pre># The client might send back the following data use POST method:

Content-type: multipart/form-data, boundary=AaB03x

--AaB03x
content-disposition: form-data; name="field1"

Joe Blow
--AaB03x
content-disposition: form-data; name="pics"; filename="file1.txt"
Content-Type: text/plain

 ... contents of file1.txt ...
--AaB03x--
</pre></td></tr></table></figure>

<p>这里通俗点讲，RFC-1867通过HTTP协议传输特定的格式来实现上传文件,比如我们上传一个文件名字叫做hello.txt的文本到服务端，那么发起请求的HTTP格式应该就如下：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre><span class="request">POST <span class="string">/up.php</span> HTTP/1.1</span>
<span class="attribute">Host</span>: <span class="string">creturn.com</span>
<span class="attribute">Content-Length</span>: <span class="string">294</span>
<span class="attribute">Content-type</span>: <span class="string">multipart/form-data, boundary=AaB03x</span>

<span class="applescript"><span class="comment">--AaB03x</span>
content-disposition: form-data; <span class="property">name</span>=<span class="string">"file"</span>; filename=<span class="string">"hello.txt"</span>
Content-Type: <span class="type">text</span>/plain

hello
<span class="comment">--AaB03x--</span></span>
</pre></td></tr></table></figure>

<p>这里HTTP头部协议没有写完整只是为了说明问题写的格式。在这些描述信息中</p>
<ol>
<li>第一个Content-type（http头部描述信息）值multipart/form-data 是告诉服务器此次发送的数据是上传文件数据, boundary是告诉服务器文件数据之间分割标示符是 AaB03x</li>
<li>在HTTP body数据中以--AaB03x 分割多个文件，每个分隔符下面的描述信息是作为上传文件的描述信息</li>
<li>发送结束后需要以分隔符加“--”符号进行标示</li>
</ol>
<p>如果这三点没有问题那么就能正确上传，当然次实例中肯定不成功因为HTTP头部协议描述信息简短切不争取（比如长度）</p>
<h2 id="-">解决过程</h2>
<p>既然上面已经对问题进行分析了，同样也知道了只要发送过程是按照RFC-1867的标准进行发送那么至少PHP是能够接收到上传的文件，那么接下来我们要解决的就是如果判断</p>
<p>或者查看xUtils发送文件过程中是否遵循了RFC-1867标准</p>
<p>那么如何查看xUtils是否发送了正确的数据格式？ 有两种方案，一个是利用代理工具抓包，另外一个方案就是直接抓包</p>
<p>这里就说说直接抓包，代理抓包可以google一大堆。</p>
<p>pc 上面建立无线热点分享给手机，这样所有的数据都通过电脑走，不会用pc分享热点的google一大堆，或者为了偷懒买个传说中的mini WIFI都行</p>
<p>抓包工具window推荐smartSniff, linux或者os x直接就tcpdump也行</p>
<p>先写个简单的app装到手机上这里给出上传代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="code"><pre>String UPLOAD_URL = <span class="string">"http://www.creturn.com/up.php"</span>;
File file = <span class="keyword">new</span> File(Environment.getExternalStorageDirectory() ,<span class="string">"hello.txt"</span>);
RequestParams params = <span class="keyword">new</span> RequestParams();
params.addBodyParameter(<span class="string">"file"</span>, file);
HttpUtils httpUtils = <span class="keyword">new</span> HttpUtils();
httpUtils.send(HttpRequest.HttpMethod.POST, UPLOAD_URL, params, <span class="keyword">new</span> RequestCallBack&lt;String&gt;() {
    <span class="annotation">@Override</span>
    <span class="comment">//上传失败处理方法</span>
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFailure</span>(HttpException arg0, String msg) {
        alert(msg);
    }
    <span class="annotation">@Override</span>
    <span class="comment">//上传进度处理</span>
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onLoading</span>(<span class="keyword">long</span> total, <span class="keyword">long</span> current,
            <span class="keyword">boolean</span> isUploading) {
        <span class="keyword">if</span> (isUploading) {
            Log.i(LOG_NAME, <span class="string">"upload:"</span> + current + <span class="string">"/"</span> + total);
        }
    }
    <span class="annotation">@Override</span>
    <span class="comment">//上传成功处理</span>
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSuccess</span>(ResponseInfo&lt;String&gt; responseInfo) {
        alert(responseInfo.result);
        Log.i(LOG_NAME, responseInfo.result);
    }
});
</pre></td></tr></table></figure>

<p>上面代码作用是把sdcard根目录的hello.txt文件上传到UPLOAD_URL, 所以在sdcard根目录放一个hello.txt文件里面内容随便写点</p>
<p>php服务端这边就直接打印上传的文件信息就行，代码很简单:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre><span class="preprocessor">&lt;?php</span>
print_r(<span class="variable">$_FILES</span>);
<span class="preprocessor">?&gt;</span>
</pre></td></tr></table></figure>

<p>如果上传成功就会反馈上传文件的信息，写好app装到手机连接好wifi然后在pc上面抓包，我这里用的是smart sniffer</p>
<ul>
<li><p>抓包</p>
<ol>
<li>打开smart sniffer </li>
<li>选择菜单 Options -&gt; Capture Options </li>
<li>选择你分享wifi的网卡</li>
<li>确定点击开始抓包</li>
</ol>
<p>在手机app上操作上传文件时候就可以看到抓包工具中已经有相应的http数据，抓包工具会对所有流量抓取所以如果有其他包干扰还可以</p>
<p>设置相应的过滤规则，这里就不阐述google就能找到</p>
<p>看看我们抓到的包内容:</p>
</li>
</ul>
<p><img src="http://www.creturn.com/asset/img/android_sniffer.png" alt="smart sniffer抓包内容"></p>
<p>图种可以看到我们上传的HTTP包信息，不过很明显反馈的信息提示是没有上传成功的。</p>
<p>那么接下来我们怎么去分析这个？怎么去排查问题？很多人应该能够想到，要是有个正确参照物不就很容易分析出问题出处？</p>
<p>那么我们在建立一个html文件用浏览器同样上传sdcard里面的hello.txt文件,html内容如下:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">html</span>&gt;</span>
<span class="tag">&lt;<span class="title">body</span>&gt;</span>

<span class="tag">&lt;<span class="title">form</span> <span class="attribute">action</span>=<span class="value">"http://www.creturn.com/up.php"</span> <span class="attribute">method</span>=<span class="value">"post"</span> <span class="attribute">enctype</span>=<span class="value">"multipart/form-data"</span>&gt;</span>
<span class="tag">&lt;<span class="title">label</span> <span class="attribute">for</span>=<span class="value">"file"</span>&gt;</span>Filename:<span class="tag">&lt;/<span class="title">label</span>&gt;</span>
<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"file"</span> <span class="attribute">name</span>=<span class="value">"file"</span> <span class="attribute">id</span>=<span class="value">"file"</span> /&gt;</span> 
<span class="tag">&lt;<span class="title">br</span> /&gt;</span>
<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"submit"</span> <span class="attribute">name</span>=<span class="value">"submit"</span> <span class="attribute">value</span>=<span class="value">"Submit"</span> /&gt;</span>
<span class="tag">&lt;/<span class="title">form</span>&gt;</span>

<span class="tag">&lt;/<span class="title">body</span>&gt;</span>
<span class="tag">&lt;/<span class="title">html</span>&gt;</span>
</pre></td></tr></table></figure>

<p> 用同样的方法抓包看看正确的包内容是什么样的:</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="code"><pre><span class="request">POST <span class="string">/up.php</span> HTTP/1.1</span>
<span class="attribute">Host</span>: <span class="string">www.creturn.com</span>
<span class="attribute">Connection</span>: <span class="string">keep-alive</span>
<span class="attribute">Content-Length</span>: <span class="string">294</span>
<span class="attribute">Cache-Control</span>: <span class="string">max-age=0</span>
<span class="attribute">Accept</span>: <span class="string">text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span>
<span class="attribute">Origin</span>: <span class="string">http://222.73.234.196</span>
<span class="attribute">User-Agent</span>: <span class="string">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36</span>
<span class="attribute">Content-Type</span>: <span class="string">multipart/form-data; boundary=----WebKitFormBoundaryIexdOW8e2EZyciDK</span>
<span class="attribute">Referer</span>: <span class="string">http://222.73.234.196/up.html</span>
<span class="attribute">Accept-Encoding</span>: <span class="string">gzip,deflate,sdch</span>
<span class="attribute">Accept-Language</span>: <span class="string">zh-CN,zh;q=0.8</span>

<span class="applescript"><span class="comment">------WebKitFormBoundaryIexdOW8e2EZyciDK</span>
Content-Disposition: form-data; <span class="property">name</span>=<span class="string">"file"</span>; filename=<span class="string">"hello.txt"</span>
Content-Type: <span class="type">text</span>/plain

hello upload
<span class="comment">------WebKitFormBoundaryIexdOW8e2EZyciDK</span>
Content-Disposition: form-data; <span class="property">name</span>=<span class="string">"submit"</span>

Submit
<span class="comment">------WebKitFormBoundaryIexdOW8e2EZyciDK--</span></span>
</pre></td></tr></table></figure>

<p> 可以看到处理HTTP头部描述信息和包体里面多了一个Submit，几乎一样</p>
<p>之前说过上传过程中的几个重点，然后对比下我们发现Content-Type描述信息多了一个charset字符编码描述信息</p>
<p>那么要做测试的话肯定就要把不同的地方去掉，然后对包进行回放看看是否成功</p>
<blockquote>
<p>包回放指的是包数据包重新发送一次</p>
</blockquote>
<p>回放数据包有两种方法，一种直接修改xUtils源码重新上传。这里说一个简单的方法window自带的telnet ,用telnet 链接服务器80端口</p>
<p>手动发送数据</p>
<blockquote>
<p>注意： windows7默认没有安装需要在控制面板-&gt;程序和功能-&gt;打开或者关闭windows功能中开启</p>
</blockquote>
<p>如何进行手动发送？按照我们之前的想法去掉charset描述信息然后手动发送，那么先去掉charset信息后的包内容放入记事本:</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="code"><pre><span class="request">POST <span class="string">/up.php</span> HTTP/1.1</span>
<span class="attribute">User-Agent</span>: <span class="string">Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_1) AppleWebKit/537.73.11 (KHTML, like Gecko) Version/7.0.1 Safari/537.73.11</span>
<span class="attribute">Content-Length</span>: <span class="string">233</span>
<span class="attribute">Content-Type</span>: <span class="string">multipart/form-data; boundary=6wYgRevA02R_Uy4EJP31EcIJtsBlZtRv</span>
<span class="attribute">Host</span>: <span class="string">wwwcreturn.com</span>
<span class="attribute">Connection</span>: <span class="string">Keep-Alive</span>
<span class="attribute">Accept-Encoding</span>: <span class="string">gzip</span>

<span class="lasso"><span class="subst">--</span><span class="number">6</span>wYgRevA02R_Uy4EJP31EcIJtsBlZtRv
Content<span class="attribute">-Disposition</span>: form<span class="attribute">-data</span>; name<span class="subst">=</span><span class="string">"file"</span>; filename<span class="subst">=</span><span class="string">"hello.txt"</span>
Content<span class="attribute">-Type</span>: application/octet<span class="attribute">-stream</span>
Content<span class="attribute">-Transfer</span><span class="attribute">-Encoding</span>: binary

hello upload

<span class="subst">--</span><span class="number">6</span>wYgRevA02R_Uy4EJP31EcIJtsBlZtRv<span class="subst">--</span></span>
</pre></td></tr></table></figure>

<p>打开cmd 然后输入telnet www.creturn.com 80 然后黏贴进去看看效果</p>
<p><img src="http://www.creturn.com/asset/img/andriod-telnet.png" alt="telnet post"></p>
<p>为了印证我们的才行可以把charset加上去和去掉的进行对比看看是不是加了之后就收不到上传文件的信息。</p>
<p>其实根据HTTP协议来讲理论上加不加charset应该不会影响上传，但结果这个问题确实是由于charset引起的。</p>
<p>接下来就简单了找到根源解决就行，在源码里面进行搜索 boundary ，找到地方根据作者写的方法注释掉其中添加charset的代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="code"><pre>    <span class="keyword">protected</span> String <span class="title">generateContentType</span>(
            <span class="keyword">final</span> String boundary,
            <span class="keyword">final</span> Charset charset) {
        StringBuilder buffer = <span class="keyword">new</span> StringBuilder();
        buffer.append(<span class="string">"multipart/"</span> + multipartSubtype + <span class="string">"; boundary="</span>);
        buffer.append(boundary);
        <span class="comment">//这里就是需要注释掉的代码</span>
        <span class="comment">/*if (charset != null) {
            buffer.append("; charset=");
            buffer.append(charset.name());
        }*/</span>
        <span class="keyword">return</span> buffer.toString();
    }
</pre></td></tr></table></figure>

<p>好了搞定收工~~</p>

	 
	     <p style="margin:20px 0; color:#9f9f9f; font-size:12px;">
<span>Posted by <a style="color:#9f9f9f;" href="null"><strong>creturn</strong></a> - 1月 15 2014</span><br />
<span style="line-height:13px;">如需转载，请注明： 本文来自 <a style="color:#9f9f9f;" href="http://creturn.com"><strong>Return&#39;s Blog </strong></a></span>
</p>
       	 
      
    </div>
    <footer>
      
	 
     		  
       		
  
  <div class="tags">
    <a href="/tags/Android/">Android</a>, <a href="/tags/xUtils/">xUtils</a>
  </div>

     		  
       	 
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


</div>
    </div>
    <div class="tabbar" onload="divideTabBar()">
	
      <div class="tabbaritem"><a class="next" href="/">Home</a></div>
    
      <div class="tabbaritem"><a class="next" href="/archives/">Archives</a></div>
    
      <div class="tabbaritem"><a class="next" href="/about/">About</a></div>
    
</div>


  </div>
</body>
</html>